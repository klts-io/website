---
title: CVE-2021-41103
weight: -202141103
short_description: |
    在容器根目录和一些系统插件中缺少必要的权限约束时，可使一个非特权的主机 Linux 用户拥有遍历容器文件系统并执行目标程序的权限。
---

{{< link text="漏洞详情" url="https://www.cvedetails.com/cve/CVE-2021-41103" >}}
{{< link text="漏洞详情(官方)" url="https://github.com/containerd/containerd/security/advisories/GHSA-c2h3-6mxw-7mvq?spm=a2c4g.11186623.0.0.392834c1nttyAo" >}}

在容器根目录和一些系统插件中缺少必要的权限约束时，可使一个非特权的主机 Linux 用户拥有遍历容器文件系统并执行目标程序的权限。

## 漏洞影响 {#scope}

在多租户场景下，如果集群节点中的容器包含扩展权限（例如 setuid），非特权的 Linux 用户可能发现并执行该程序。如果非特权的主机 Linux 用户 UID 碰撞到了容器中执行程序的所属用户或组，这个非特权的 Linux 用户可以读写该文件从而导致越权访问。

### 漏洞评分 {#cvss}

该漏洞为高危漏洞， `CVSS` 评分为 7.2。

## 防范措施 {#prevention}

保证集群节点登录用户都是可信用户，限制非受信用户对集群节点的访问权限。
收敛容器 bundles 目录中不必要的扩展权限。

## 官方修复的版本 {#official-fixed}

- v1.4.11
- v1.5.7

## KLTS 修复的版本 {#klts-fixed}

- {{< link url="/docs/containerd/releases/v1.3/v1.3.10-lts.1/" >}} {{< link text="CVE-2021-41103.1.3.patch" url="https://github.com/klts-io/containerd-lts/raw/main/patches/CVE-2021-41103.1.3.patch" >}}
