<!doctype html><html lang=zh class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.87.0"><link rel=canonical type=text/html href=/zh/docs/patches/>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>修复的漏洞 | KLTS.io</title>
<meta name=description content="KLTS 的官网"><meta property="og:title" content="修复的漏洞">
<meta property="og:description" content="KLTS 的官网">
<meta property="og:type" content="website">
<meta property="og:url" content="/zh/docs/patches/"><meta property="og:site_name" content="KLTS.io">
<meta itemprop=name content="修复的漏洞">
<meta itemprop=description content="KLTS 的官网"><meta name=twitter:card content="summary">
<meta name=twitter:title content="修复的漏洞">
<meta name=twitter:description content="KLTS 的官网">
<link rel=preload href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css as=style>
<link href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/zh/>
<span class=navbar-logo><svg id="Graph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g id="KLTS_-_Graph_-_Light" data-name="KLTS - Graph - Light"><path id="Secondary" d="M174.54 276.539c-23.254 5.244-46.3 13.984-70.386 26.563V249.768A322.072 322.072.0 01153.4 232.2q11.784-3.111 23.743-5.193a84.322 84.322.0 00-2.6 49.53zm54.832-100.2c-18.627-17.387-38.964-31.808-61.2-44.965L119.7 159.357c29.816 15.76 52.067 30.719 69.575 45.639a84.135 84.135.0 0140.097-28.661zm20.63-4.1c1.983-.14 3.979-.237 6-.237a83.588 83.588.0 0141.393 10.916 251.959 251.959.0 00.78-28.448 297.8 297.8.0 00-6.564-53.245L256 80.664l-16.489 9.52c6.65 24.114 10.095 45.37 10.682 65.672Q250.433 164.112 250 172.237zm-64.76 129.007q-4.648 8.227-8.758 16.752a324.529 324.529.0 00-20.49 55.6l43.21 24.947c5.824-24.5 13.469-45.93 23.455-65.437A84.3 84.3.0 01185.242 301.244zM374.19 148.9c-19 18.863-37.743 34.831-58.691 47.809a83.826 83.826.0 0122.786 42.325c25.366-15.381 47.642-34.187 69.561-55.9v-14.8zM298.741 328.308A83.582 83.582.0 01256 340q-2.149.0-4.272-.108c1.842 4.863 3.807 9.68 5.93 14.446 8.355 18.751 19.118 37.369 33 56.991l41.757-24.108c-13.306-18.382-23.351-35.46-30.908-52.419C300.542 332.644 299.63 330.478 298.741 328.308zm40.874-64.358a83.578 83.578.0 01-18.131 44.635c26.246 8.936 54.539 14.141 86.362 16.028v-48.08a284.525 284.525.0 01-57.161-9.231Q345.087 265.763 339.615 263.95z" fill="#fff" opacity=".66"/><path id="Primary" d="M256 71.426l159.846 92.287V348.287L256 440.574 96.154 348.287V163.713L256 71.426M256 16 48.154 136V376L256 496 463.846 376V136L256 16zm0 204a36 36 0 11-25.456 10.544A35.767 35.767.0 01256 220m0-48a84 84 0 1059.4 24.6A83.738 83.738.0 00256 172z" fill="#fff"/><rect id="Frame" width="512" height="512" fill="none"/></g></svg></span><span class="text-uppercase font-weight-bold">KLTS.io</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/about/><span>关于</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/blog/><span>博客</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/zh/docs/><span class=active>文档</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中文 Chinese
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/>English</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off data-offline-search-index-json-src=/offline-search-index.c0c660a9a25ecd2873c750202f13ce46.json data-offline-search-base-href=/ data-offline-search-max-results=10>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.
</p><p>
<a href=/zh/docs/patches/>返回本页常规视图</a>.
</p>
</div>
<h1 class=title>修复的漏洞</h1>
<ul>
<li>1: <a href=#pg-be897afcde62036b99d0be161d71d482>CVE-2021-25741</a></li>
<li>2: <a href=#pg-d4317cf8912bca37373fe5558d2d6285>CVE-2021-3121</a></li>
<li>3: <a href=#pg-ce240d314dc85c8ab698d26f1466e5a2>CVE-2020-8559</a></li>
<li>4: <a href=#pg-5aa68ad2e414f83fec8b9beb2250fdd3>CVE-2020-8558</a></li>
<li>5: <a href=#pg-c1ec3633b18a80bee04f17816082420b>CVE-2020-8552</a></li>
<li>6: <a href=#pg-fa6c26ffb59581078942a7046be853db>CVE-2019-1002101</a></li>
<li>7: <a href=#pg-3bb42a6493fbd1d3d06aad85c3d8d1e7>CVE-2019-11251</a></li>
<li>8: <a href=#pg-da5de8654ce647927106ce1dae3b6382>CVE-2019-11248</a></li>
<li>9: <a href=#pg-d902d3ffd5b3d43bf94a51814ab569c7>CVE-2019-11247</a></li>
<li>10: <a href=#pg-17adf9e532c044f0bc96bf2fe6fabb70>CVE-2019-11246</a></li>
<li>11: <a href=#pg-678704d1c81cba20ab7f9af62e484052>CVE-2019-11245</a></li>
<li>12: <a href=#pg-9677918ea7ce2b1d4116bfb9d4d31512>CVE-2019-11249</a></li>
<li>13: <a href=#pg-66481705776642cc7da302c2a84c2907>nokmem</a></li>
</ul>
<div class=content>
</div>
</div>
<div class=td-content>
<h1 id=pg-be897afcde62036b99d0be161d71d482>1 - CVE-2021-25741</h1>
<a href=https://www.cvedetails.com/cve/CVE-2021-25741/ target=_blank>漏洞详情</a>
<p>这是一个权限访问相关的卷安全性问题。用户可以在创建的容器中通过 <code>subpath</code> 的卷挂载方式访问到该卷挂载目录之外的文件和目录，包括主机的文件系统。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞影响 <code>kubelet</code> 相关行为，对于严格限制 <code>hostPath</code> 创建行为的集群管理员来说问题尤为严重。</p>
<h3 id=cvss>漏洞评分</h3>
<p>该漏洞为中危漏洞， <code>CVSS</code> 评分为 5.5。</p>
<h2 id=prevention>防范措施</h2>
<p>对于不想升级 <code>kubelet</code> 的用户来说，可以有两种防范措施：</p>
<ul>
<li>禁止 <code>kubelet</code>，<code>kube-apiserver</code> 的 <code>VolumeSubpath</code> 功能，并且移除所有正在使用该功能的 <code>pod</code>。</li>
<li>使用 <code>admission control</code> 防止信任度较低的用户使用 <code>root</code> 权限运行容器。</li>
</ul>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.22.2</li>
<li>v1.21.5</li>
<li>v1.20.11</li>
<li>v1.19.15</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.18.20/v1.18.20-lts.1 title="这是 KLTS 发布的第一个 v1.18.20 修复版本。" data-toggle=tooltip data-placement=top target>v1.18.20-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/104253.patch target=_blank>kubernetes/kubernetes#104253</a></li>
<li><a href=/zh/docs/releases/v1.17.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.16.15/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-d4317cf8912bca37373fe5558d2d6285>2 - CVE-2021-3121</h1>
<a href=https://www.cvedetails.com/cve/CVE-2021-3121 target=_blank>漏洞详情</a>
<p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>Kubernetes</code> 系统组件由于自身有应对崩溃的恢复机制，当遇到恶意提交的 <code>Protobuf</code> 消息时不会中断服务，所以不在该漏洞的影响范围内。</p>
<p>在应用系统中程序接收处理 <code>Protobuf</code> 消息时，如果组件没有应对崩溃的恢复机制，那么这类程序都在该漏洞影响范围内，且被恶意攻击时服务可能会中断。</p>
<p><code>Kubernetes</code> 社区经过测试验证 <code>API Server</code> 不受该漏洞的影响，但为了避免您受到该安全漏洞隐患的影响，社区对相关 <code>Protobuf</code> 文件进行了升级，具体修复版本如下:</p>
<h2 id=prevention>防范措施</h2>
<p>如果在您的应用系统代码中使用了自动生成的 <code>Protobuf</code> 消息，并且发现相关组件因为以下异常退出，则可能存在该漏洞。</p>
<pre><code>panic: runtime error: index out of range [-9223372036854775804]

goroutine 1 [running]:

v1.(*MessageName).Unmarshal(0xc00006f1e8, 0xc0000281a8, 0xa, 0x10, 0xc00006f1b8, 0x1)

        .../protofile.pb.go:250 +0xb86
</code></pre><p>如果您使用了 <code>Protobuf</code> 消息的相关组件，推荐将 <code>Gogo Protobuf</code> 编译器升级到漏洞修复版本（v1.3.2 或更高的版本），再基于升级后的 <code>Protobuf</code> 编译器重新生成相关的 <code>Protobuf</code> 消息。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.21.1</li>
<li>v1.20.7</li>
<li>v1.19.11</li>
<li>v1.18.19</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.17.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.16.15/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ce240d314dc85c8ab698d26f1466e5a2>3 - CVE-2020-8559</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8559 target=_blank>漏洞详情</a>
<p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p>
<h2 id=scope>漏洞影响</h2>
<p>由于 <code>kube-apiserver</code> 在升级请求的代理后端中允许将请求传播回源客户端，所以攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，然后利用请求中原有的访问凭据转发请求至其他目标节点，从而造成被攻击节点出现权限提升的漏洞。</p>
<h3 id=cvss>漏洞评分</h3>
<p>该漏洞为中危漏洞， <code>CVSS</code> 评分为 6.4。
如果有多个集群共享使用了相同的 <code>CA</code> 和认证凭证，攻击者可以利用此漏洞攻击其他集群，这种情况下该漏洞为高危漏洞。</p>
<h2 id=prevention>防范措施</h2>
<p>对于集群内跨节点的攻击，建议您采取以下安全防范措施：</p>
<ul>
<li>及时吊销可能泄露的 <code>kubeconfig</code> 凭证，并且遵循权限最小化原则，收敛子账号不必要的 <code>pods/exec</code>、<code>pods/attach</code>、<code>pods/portforward</code> 和 <code>proxy</code> 类型的资源模型 <code>RBAC</code> 权限。</li>
</ul>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.18.6</li>
<li>v1.17.9</li>
<li>v1.16.13</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92971.patch target=_blank>kubernetes/kubernetes#92971</a></li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92971.patch target=_blank>kubernetes/kubernetes#92971</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-5aa68ad2e414f83fec8b9beb2250fdd3>4 - CVE-2020-8558</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8558 target=_blank>漏洞详情</a>
<p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p>
<h2 id=scope>漏洞影响</h2>
<p>当攻击者拥有主机网络配置能力或运行在一个具备了 <code>CAP_NET_RAW</code> 能力的容器实例时，就可以获取在目标节点上监听 <code>127.0.0.1</code> 的服务 <code>socket</code> 信息。如果在目标主机上存在 <code>127.0.0.1</code> 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。</p>
<h3 id=cvss>漏洞评分</h3>
<ul>
<li>如果集群 <code>API Server</code> 开启了非认证端口（默认 8080），那么攻击者可能获取到 <code>API Server</code> 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。</li>
<li>如果集群 <code>API Server</code> 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。</li>
</ul>
<h2 id=prevention>防范措施</h2>
<p>建议您采取以下安全防范措施：</p>
<p>如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 <code>iptables</code> 规则来缓解此漏洞。
执行以下命令在集群中配置 <code>iptables</code> 规则，用于拒绝非本地对 <code>127.0.0.1</code> 的访问流量：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP
</code></pre></div><p>如果集群不需要开启 API Server 不安全端口，可以将 <code>--insecure-port=0</code> 添加到 kubernetes API 服务器命令行来禁用端口。</p>
<p>如集群内运行不受信任的容器，可以禁止 <code>Container</code> 开启 <code>CAP_NET_RAW</code> 能力，在 <code>pod spec</code> 中关闭 <code>Container</code> 的 <code>CAP_NET_RAW</code> 能力。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>securityContext</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>capabilities</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>drop</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> 
</span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#4e9a06>&#34;NET_RAW&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>通过 <code>PodSecurityPolicy</code> 策略限制部署特权或共享主机网络容器，另外可以通过在策略中配置 <code>requiredDropCapabilities</code> 强制容器部署关闭 <code>CAP_NET_RAW</code> 能力。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.18.4</li>
<li>v1.17.7</li>
<li>v1.16.11</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-c1ec3633b18a80bee04f17816082420b>5 - CVE-2020-8552</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8552 target=_blank>漏洞详情</a>
<p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.17.3</li>
<li>v1.16.7</li>
<li>v1.15.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8552.1.14.patch target=_blank>CVE-2020-8552.1.14.patch</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8552.1.13.patch target=_blank>CVE-2020-8552.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8552.1.13.patch target=_blank>CVE-2020-8552.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8552.1.11.patch target=_blank>CVE-2020-8552.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8552.1.11.patch target=_blank>CVE-2020-8552.1.11.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-fa6c26ffb59581078942a7046be853db>6 - CVE-2019-1002101</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-1002101 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者在 <code>kubectl cp</code> 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>kubectl cp</code> 命令允许用户在容器和用户机器之间拷贝文件，攻击者可能通过在镜像或运行容器中植入带有符号链接（symbolic links）头的恶意 <code>tar</code> 包，在 <code>cp</code> 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.1</li>
<li>v1.13.6</li>
<li>v1.12.8</li>
<li>v1.11.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-1002101.1.10.patch target=_blank>CVE-2019-1002101.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-3bb42a6493fbd1d3d06aad85c3d8d1e7>7 - CVE-2019-11251</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11251 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a>、<a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a>、<a href=/zh/docs/patches/cve-2019-11249 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11249</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝，当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，然后 <code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历(Path Traversal)。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.15.4</li>
<li>v1.14.7</li>
<li>v1.13.11</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/82503.patch target=_blank>kubernetes/kubernetes#82503</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/82503.patch target=_blank>kubernetes/kubernetes#82503</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11251.1.10.patch target=_blank>CVE-2019-11251.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-da5de8654ce647927106ce1dae3b6382>8 - CVE-2019-11248</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11248 target=_blank>漏洞详情</a>
<p>可以通过健康检查的端口访问 <code>/debug/pprof</code>。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞存在于 <code>Kubelet</code> 中，用于性能调试的 <code>/debug/pprof</code> 跟健康检查端口 <code>/healthz</code> 绑定在一起，其中 <code>/debug/pprof</code> 会进行安全认证，但 <code>/healthz</code> 接口并不进行认证鉴权。所以如果 <code>Kubelet</code> 的 <code>healthz</code> 地址未使用 <code>localhost</code>，则会存在泄露机器敏感信息的风险。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.4</li>
<li>v1.13.8</li>
<li>v1.12.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11248.1.11.patch target=_blank>CVE-2019-11248.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11248.1.11.patch target=_blank>CVE-2019-11248.1.11.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-d902d3ffd5b3d43bf94a51814ab569c7>9 - CVE-2019-11247</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11247 target=_blank>漏洞详情</a>
<p><code>API Server</code> 允许通过错误的范围访问自定义的资源。</p>
<h2 id=scope>漏洞影响</h2>
<p>如果某个用户请求的资源已划分到命名空间，Kubernetes kube-apiserver 将错误地允许该用户访问集群范围内的自定义资源。</p>
<p>以这种方式访问资源将等同于授予命名空间内所有角色及其权限，这意味着本来只能访问命名空间中一个资源的用户将能够创建、查看、更新或删除整个集群范围的资源（具体取决于其命名空间角色权限）。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.12.12</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11247.1.11.patch target=_blank>CVE-2019-11247.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-17adf9e532c044f0bc96bf2fe6fabb70>10 - CVE-2019-11246</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11246 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历 (Path Traversal) 的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝。当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，<code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历 (Path Traversal) 方式将恶意文件写入任意路径。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.3</li>
<li>v1.13.7</li>
<li>v1.12.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11246.1.11.patch target=_blank>CVE-2019-11246.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11246.1.10.patch target=_blank>CVE-2019-11246.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-678704d1c81cba20ab7f9af62e484052>11 - CVE-2019-11245</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11245 target=_blank>漏洞详情</a>
<p>这是一个提权漏洞，通常以容器 <code>Dockerfile</code> 中指定的 <code>USER</code> 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p>
<h2 id=scope>漏洞影响</h2>
<p>所有未指定 <code>mustRunAsNonRoot: true</code> 的 <code>Pod</code>，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p>
<h2 id=prevention>防范措施</h2>
<p>为 <code>Pod</code> 指定 <code>mustRunAsNonRoot: true</code>。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.3</li>
<li>v1.13.7</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-9677918ea7ce2b1d4116bfb9d4d31512>12 - CVE-2019-11249</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11249 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a>、<a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝，当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，然后 <code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历 (Path Traversal)。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.15.2</li>
<li>v1.14.5</li>
<li>v1.13.9</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.12.patch target=_blank>CVE-2019-11249.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.12.patch target=_blank>CVE-2019-11249.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.10.patch target=_blank>CVE-2019-11249.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-66481705776642cc7da302c2a84c2907>13 - nokmem</h1>
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1507149" target=_blank>Bug 详情</a>
<p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p>
<h2 id=scope>Bug 影响</h2>
<p>节点长期使用的时候提示剩余空间不足的错误，报错信息如下所示：</p>
<pre><code>mkdir: cannot create directory '/sys/fs/cgroup/memory/8': No space left on device
</code></pre><p>节点磁盘充足但是一直报和这个错误, 并且创建 <code>Pod</code> 总是失败，这是一个潜在的“定时炸弹”。</p>
<p>所有使用低版本内核的环境，Kubernetes 1.22 之前的版本都会受到影响, 在 runc 1.0.0-rc94 (<a href=https://github.com/opencontainers/runc/pull/2840 target=_blank>opencontainers/runc#2840</a>) 修复(直接移除了)</p>
<h2 id=prevention>防范措施</h2>
<ul>
<li>升级系统内核</li>
<li>Kubernetes 1.14 及以上
<ul>
<li>重新构建 Kubelet 带上 <code>-tags=nokmem</code></li>
</ul>
</li>
<li>Kubernetes 1.14 以下
<ul>
<li>硬编码, 请参考 <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
</ul>
</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.18.20/v1.18.20-lts.1 title="这是 KLTS 发布的第一个 v1.18.20 修复版本。" data-toggle=tooltip data-placement=top target>v1.18.20-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.18.patch target=_blank>nokmem.1.18.patch</a></li>
<li><a href=/zh/docs/releases/v1.17.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.18.patch target=_blank>nokmem.1.18.patch</a></li>
<li><a href=/zh/docs/releases/v1.16.15/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.18.patch target=_blank>nokmem.1.18.patch</a></li>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.18.patch target=_blank>nokmem.1.18.patch</a></li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.18.patch target=_blank>nokmem.1.18.patch</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
</ul>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/klts-io aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack>
<a class=text-white target=_blank rel=noopener href=https://klts.slack.com aria-label=Slack>
<i class="fab fa-slack"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list">
<a class=text-white target=_blank rel=noopener href=mailto:klts-io@googlegroups.com aria-label="Developer mailing list">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2021 The KLTS.io Authors 版权所有</small>
<p class=mt-2><a href=/zh/about/>关于 KLTS</a></p>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script>
</body>
</html>