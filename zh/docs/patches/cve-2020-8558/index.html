<!doctype html><html lang=zh class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.87.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>CVE-2020-8558 | KLTS.io</title>
<meta name=description content="KLTS 的官网"><meta property="og:title" content="CVE-2020-8558">
<meta property="og:description" content="漏洞详情 kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。
漏洞影响 当攻击者拥有主机网络配置能力或运行在一个具备了 CAP_NET_RAW 能力的容器实例时，就可以获取在目标节点上监听 127.0.0.1 的服务 socket 信息。如果在目标主机上存在 127.0.0.1 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。
漏洞评分  如果集群 API Server 开启了非认证端口（默认 8080），那么攻击者可能获取到 API Server 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。 如果集群 API Server 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。  防范措施 建议您采取以下安全防范措施：
如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 iptables 规则来缓解此漏洞。 执行以下命令在集群中配置 iptables 规则，用于拒绝非本地对 127.0.0.1 的访问流量：
iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP 如果集群不需要开启 API Server 不安全端口，可以将 --insecure-port=0 添加到 kubernetes API 服务器命令行来禁用端口。">
<meta property="og:type" content="article">
<meta property="og:url" content="/zh/docs/patches/cve-2020-8558/"><meta property="article:section" content="docs">
<meta property="article:modified_time" content="2021-10-19T11:16:44+08:00"><meta property="og:site_name" content="KLTS.io">
<meta itemprop=name content="CVE-2020-8558">
<meta itemprop=description content="漏洞详情 kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。
漏洞影响 当攻击者拥有主机网络配置能力或运行在一个具备了 CAP_NET_RAW 能力的容器实例时，就可以获取在目标节点上监听 127.0.0.1 的服务 socket 信息。如果在目标主机上存在 127.0.0.1 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。
漏洞评分  如果集群 API Server 开启了非认证端口（默认 8080），那么攻击者可能获取到 API Server 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。 如果集群 API Server 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。  防范措施 建议您采取以下安全防范措施：
如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 iptables 规则来缓解此漏洞。 执行以下命令在集群中配置 iptables 规则，用于拒绝非本地对 127.0.0.1 的访问流量：
iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP 如果集群不需要开启 API Server 不安全端口，可以将 --insecure-port=0 添加到 kubernetes API 服务器命令行来禁用端口。">
<meta itemprop=dateModified content="2021-10-19T11:16:44+08:00">
<meta itemprop=wordCount content="114">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="CVE-2020-8558">
<meta name=twitter:description content="漏洞详情 kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。
漏洞影响 当攻击者拥有主机网络配置能力或运行在一个具备了 CAP_NET_RAW 能力的容器实例时，就可以获取在目标节点上监听 127.0.0.1 的服务 socket 信息。如果在目标主机上存在 127.0.0.1 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。
漏洞评分  如果集群 API Server 开启了非认证端口（默认 8080），那么攻击者可能获取到 API Server 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。 如果集群 API Server 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。  防范措施 建议您采取以下安全防范措施：
如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 iptables 规则来缓解此漏洞。 执行以下命令在集群中配置 iptables 规则，用于拒绝非本地对 127.0.0.1 的访问流量：
iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP 如果集群不需要开启 API Server 不安全端口，可以将 --insecure-port=0 添加到 kubernetes API 服务器命令行来禁用端口。">
<link rel=preload href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css as=style>
<link href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/zh/>
<span class=navbar-logo><svg id="Graph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g id="KLTS_-_Graph_-_Light" data-name="KLTS - Graph - Light"><path id="Secondary" d="M174.54 276.539c-23.254 5.244-46.3 13.984-70.386 26.563V249.768A322.072 322.072.0 01153.4 232.2q11.784-3.111 23.743-5.193a84.322 84.322.0 00-2.6 49.53zm54.832-100.2c-18.627-17.387-38.964-31.808-61.2-44.965L119.7 159.357c29.816 15.76 52.067 30.719 69.575 45.639a84.135 84.135.0 0140.097-28.661zm20.63-4.1c1.983-.14 3.979-.237 6-.237a83.588 83.588.0 0141.393 10.916 251.959 251.959.0 00.78-28.448 297.8 297.8.0 00-6.564-53.245L256 80.664l-16.489 9.52c6.65 24.114 10.095 45.37 10.682 65.672Q250.433 164.112 250 172.237zm-64.76 129.007q-4.648 8.227-8.758 16.752a324.529 324.529.0 00-20.49 55.6l43.21 24.947c5.824-24.5 13.469-45.93 23.455-65.437A84.3 84.3.0 01185.242 301.244zM374.19 148.9c-19 18.863-37.743 34.831-58.691 47.809a83.826 83.826.0 0122.786 42.325c25.366-15.381 47.642-34.187 69.561-55.9v-14.8zM298.741 328.308A83.582 83.582.0 01256 340q-2.149.0-4.272-.108c1.842 4.863 3.807 9.68 5.93 14.446 8.355 18.751 19.118 37.369 33 56.991l41.757-24.108c-13.306-18.382-23.351-35.46-30.908-52.419C300.542 332.644 299.63 330.478 298.741 328.308zm40.874-64.358a83.578 83.578.0 01-18.131 44.635c26.246 8.936 54.539 14.141 86.362 16.028v-48.08a284.525 284.525.0 01-57.161-9.231Q345.087 265.763 339.615 263.95z" fill="#fff" opacity=".66"/><path id="Primary" d="M256 71.426l159.846 92.287V348.287L256 440.574 96.154 348.287V163.713L256 71.426M256 16 48.154 136V376L256 496 463.846 376V136L256 16zm0 204a36 36 0 11-25.456 10.544A35.767 35.767.0 01256 220m0-48a84 84 0 1059.4 24.6A83.738 83.738.0 00256 172z" fill="#fff"/><rect id="Frame" width="512" height="512" fill="none"/></g></svg></span><span class="text-uppercase font-weight-bold">KLTS.io</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/about/><span>关于</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/blog/><span>博客</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/zh/docs/><span class=active>文档</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中文 Chinese
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/docs/patches/cve-2020-8558/>English</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off data-offline-search-index-json-src=/offline-search-index.6c4c5b49e59f085624e3b413bfa50634.json data-offline-search-base-href=/ data-offline-search-max-results=10>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off data-offline-search-index-json-src=/offline-search-index.6c4c5b49e59f085624e3b413bfa50634.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<div class="nav-item dropdown d-block d-lg-none">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中文 Chinese
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/docs/patches/cve-2020-8558/>English</a>
</div>
</div>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-zhdocs-li>
<a href=/zh/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-zhdocs><span>文档</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsintro-li>
<a href=/zh/docs/intro/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsintro><span>简介</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspre-install-li>
<a href=/zh/docs/pre-install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspre-install><span>准备</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsinstall-li>
<a href=/zh/docs/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsinstall><span>正常安装</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsinstall-with-script-li>
<a href=/zh/docs/install-with-script/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsinstall-with-script><span>脚本一键安装</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-zhdocspatches-li>
<a href=/zh/docs/patches/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocspatches><span>修复的漏洞</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2021-25741-li>
<a href=/zh/docs/patches/cve-2021-25741/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2021-25741><span>CVE-2021-25741</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2021-3121-li>
<a href=/zh/docs/patches/cve-2021-3121/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2021-3121><span>CVE-2021-3121</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2020-8559-li>
<a href=/zh/docs/patches/cve-2020-8559/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2020-8559><span>CVE-2020-8559</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-zhdocspatchescve-2020-8558-li>
<a href=/zh/docs/patches/cve-2020-8558/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2020-8558><span class=td-sidebar-nav-active-item>CVE-2020-8558</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2020-8552-li>
<a href=/zh/docs/patches/cve-2020-8552/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2020-8552><span>CVE-2020-8552</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-1002101-li>
<a href=/zh/docs/patches/cve-2019-1002101/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-1002101><span>CVE-2019-1002101</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11251-li>
<a href=/zh/docs/patches/cve-2019-11251/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11251><span>CVE-2019-11251</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11248-li>
<a href=/zh/docs/patches/cve-2019-11248/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11248><span>CVE-2019-11248</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11247-li>
<a href=/zh/docs/patches/cve-2019-11247/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11247><span>CVE-2019-11247</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11246-li>
<a href=/zh/docs/patches/cve-2019-11246/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11246><span>CVE-2019-11246</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11245-li>
<a href=/zh/docs/patches/cve-2019-11245/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11245><span>CVE-2019-11245</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchescve-2019-11249-li>
<a href=/zh/docs/patches/cve-2019-11249/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchescve-2019-11249><span>CVE-2019-11249</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocspatchesnokmem-li>
<a href=/zh/docs/patches/nokmem/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocspatchesnokmem><span>nokmem</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsaddpatchadd-patch-li>
<a href=/zh/docs/addpatch/add-patch/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsaddpatchadd-patch><span>添加 CVE 补丁到 klts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleases-li>
<a href=/zh/docs/releases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleases><span>版本日志</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11916-li>
<a href=/zh/docs/releases/v1.19.16/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11916><span>v1.19.16</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11916v11916-lts1-li>
<a href=/zh/docs/releases/v1.19.16/v1.19.16-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11916v11916-lts1><span>v1.19.16-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11820-li>
<a href=/zh/docs/releases/v1.18.20/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11820><span>v1.18.20</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11820v11820-lts1-li>
<a href=/zh/docs/releases/v1.18.20/v1.18.20-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11820v11820-lts1><span>v1.18.20-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11717-li>
<a href=/zh/docs/releases/v1.17.17/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11717><span>v1.17.17</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11717v11717-lts1-li>
<a href=/zh/docs/releases/v1.17.17/v1.17.17-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11717v11717-lts1><span>v1.17.17-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11615-li>
<a href=/zh/docs/releases/v1.16.15/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11615><span>v1.16.15</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11615v11615-lts1-li>
<a href=/zh/docs/releases/v1.16.15/v1.16.15-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11615v11615-lts1><span>v1.16.15-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11512-li>
<a href=/zh/docs/releases/v1.15.12/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11512><span>v1.15.12</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11512v11512-lts1-li>
<a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11512v11512-lts1><span>v1.15.12-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11410-li>
<a href=/zh/docs/releases/v1.14.10/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11410><span>v1.14.10</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11410v11410-lts1-li>
<a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11410v11410-lts1><span>v1.14.10-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11312-li>
<a href=/zh/docs/releases/v1.13.12/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11312><span>v1.13.12</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11312v11312-lts1-li>
<a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11312v11312-lts1><span>v1.13.12-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11210-li>
<a href=/zh/docs/releases/v1.12.10/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11210><span>v1.12.10</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11210v11210-lts1-li>
<a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11210v11210-lts1><span>v1.12.10-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11110-li>
<a href=/zh/docs/releases/v1.11.10/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11110><span>v1.11.10</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11110v11110-lts1-li>
<a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11110v11110-lts1><span>v1.11.10-lts.1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsreleasesv11013-li>
<a href=/zh/docs/releases/v1.10.13/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsreleasesv11013><span>v1.10.13</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsreleasesv11013v11013-lts1-li>
<a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsreleasesv11013v11013-lts1><span>v1.10.13-lts.1</span></a>
</li>
</ul>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocscontainerd-li>
<a href=/zh/docs/containerd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocscontainerd><span>Containerd</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocscontainerdpatches-li>
<a href=/zh/docs/containerd/patches/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocscontainerdpatches><span>修复的漏洞</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocscontainerdpatchescve-2021-41103-li>
<a href=/zh/docs/containerd/patches/cve-2021-41103/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocscontainerdpatchescve-2021-41103><span>CVE-2021-41103</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocscontainerdreleases-li>
<a href=/zh/docs/containerd/releases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocscontainerdreleases><span>版本日志</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocscontainerdreleasesv1310-li>
<a href=/zh/docs/containerd/releases/v1.3.10/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocscontainerdreleasesv1310><span>v1.3.10</span></a>
<ul class="ul-4 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocscontainerdreleasesv1310v1310-lts1-li>
<a href=/zh/docs/containerd/releases/v1.3.10/v1.3.10-lts.1/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocscontainerdreleasesv1310v1310-lts1><span>v1.3.10-lts.1</span></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zhdocsdeveloper-guide-li>
<a href=/zh/docs/developer-guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zhdocsdeveloper-guide><span>开发指南</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsdeveloper-guideclone-li>
<a href=/zh/docs/developer-guide/clone/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsdeveloper-guideclone><span>克隆</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zhdocsdeveloper-guidedependent-li>
<a href=/zh/docs/developer-guide/dependent/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zhdocsdeveloper-guidedependent><span>依赖</span></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href=https://github.com/klts-io/website/edit/main/content/zh/docs/patches/cve-2020-8558.md target=_blank><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/klts-io/website/new/main/content/zh/docs/patches/cve-2020-8558.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/klts-io/website/issues/new?title=CVE-2020-8558" target=_blank><i class="fab fa-github fa-fw"></i> 提交文档问题</a>
<a href=https://github.com/klts-io/website/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> 提交项目问题</a>
<a id=print href=/zh/docs/patches/_print/><i class="fa fa-print fa-fw"></i> 整节打印</a>
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#scope>漏洞影响</a>
<ul>
<li><a href=#cvss>漏洞评分</a></li>
</ul>
</li>
<li><a href=#prevention>防范措施</a></li>
<li><a href=#official-fixed>官方修复的版本</a></li>
<li><a href=#klts-fixed>KLTS 修复的版本</a></li>
</ul>
</nav></div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<nav aria-label=breadcrumb class="d-none d-md-block d-print-none">
<ol class="breadcrumb spb-1">
<li class=breadcrumb-item>
<a href=/zh/docs/>文档</a>
</li>
<li class=breadcrumb-item>
<a href=/zh/docs/patches/>修复的漏洞</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
<a href=/zh/docs/patches/cve-2020-8558/>CVE-2020-8558</a>
</li>
</ol>
</nav>
<div class=td-content>
<h1>CVE-2020-8558</h1>
<header class=article-meta>
<p class=reading-time><i class="fa fa-clock" aria-hidden=true></i> 1 分钟 阅读时间</p>
</header>
<a href=https://www.cvedetails.com/cve/CVE-2020-8558 target=_blank>漏洞详情</a>
<p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p>
<h2 id=scope>漏洞影响</h2>
<p>当攻击者拥有主机网络配置能力或运行在一个具备了 <code>CAP_NET_RAW</code> 能力的容器实例时，就可以获取在目标节点上监听 <code>127.0.0.1</code> 的服务 <code>socket</code> 信息。如果在目标主机上存在 <code>127.0.0.1</code> 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。</p>
<h3 id=cvss>漏洞评分</h3>
<ul>
<li>如果集群 <code>API Server</code> 开启了非认证端口（默认 8080），那么攻击者可能获取到 <code>API Server</code> 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。</li>
<li>如果集群 <code>API Server</code> 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。</li>
</ul>
<h2 id=prevention>防范措施</h2>
<p>建议您采取以下安全防范措施：</p>
<p>如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 <code>iptables</code> 规则来缓解此漏洞。
执行以下命令在集群中配置 <code>iptables</code> 规则，用于拒绝非本地对 <code>127.0.0.1</code> 的访问流量：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP
</code></pre></div><p>如果集群不需要开启 API Server 不安全端口，可以将 <code>--insecure-port=0</code> 添加到 kubernetes API 服务器命令行来禁用端口。</p>
<p>如集群内运行不受信任的容器，可以禁止 <code>Container</code> 开启 <code>CAP_NET_RAW</code> 能力，在 <code>pod spec</code> 中关闭 <code>Container</code> 的 <code>CAP_NET_RAW</code> 能力。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>securityContext</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>capabilities</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>drop</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> 
</span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#4e9a06>&#34;NET_RAW&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>通过 <code>PodSecurityPolicy</code> 策略限制部署特权或共享主机网络容器，另外可以通过在策略中配置 <code>requiredDropCapabilities</code> 强制容器部署关闭 <code>CAP_NET_RAW</code> 能力。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.18.4</li>
<li>v1.17.7</li>
<li>v1.16.11</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.15.12/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.14.10/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.13.12/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.12.10/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.11.10/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/master/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.10.13/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
<div class="text-muted mt-5 pt-3 border-top">
最后修改
2021.10.19
: <a href=https://github.com/klts-io/website/commit/1dcd43d5f7c81163a62bd663af4a2e307c5bcdff>Update cve-2020-8558.md (1dcd43d5)</a>
</div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/klts-io aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack>
<a class=text-white target=_blank rel=noopener href=https://klts.slack.com aria-label=Slack>
<i class="fab fa-slack"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list">
<a class=text-white target=_blank rel=noopener href=mailto:klts-io@googlegroups.com aria-label="Developer mailing list">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2021 The KLTS.io Authors 版权所有</small>
<p class=mt-2><a href=/zh/about/>关于 KLTS</a></p>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script>
</body>
</html>