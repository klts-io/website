<!doctype html><html lang=zh class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.87.0"><link rel=canonical type=text/html href=/zh/docs/>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>文档 | KLTS.io</title>
<meta name=description content="KLTS 的官网"><meta property="og:title" content="文档">
<meta property="og:description" content="KLTS 的官网">
<meta property="og:type" content="website">
<meta property="og:url" content="/zh/docs/"><meta property="og:site_name" content="KLTS.io">
<meta itemprop=name content="文档">
<meta itemprop=description content="KLTS 的官网"><meta name=twitter:card content="summary">
<meta name=twitter:title content="文档">
<meta name=twitter:description content="KLTS 的官网">
<link rel=preload href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css as=style>
<link href=/scss/main.min.650bdee92aa16b3ae39822dd8dfd62356c714a590c397f4abe76572440c62901.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/zh/>
<span class=navbar-logo><svg id="Graph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g id="KLTS_-_Graph_-_Light" data-name="KLTS - Graph - Light"><path id="Secondary" d="M174.54 276.539c-23.254 5.244-46.3 13.984-70.386 26.563V249.768A322.072 322.072.0 01153.4 232.2q11.784-3.111 23.743-5.193a84.322 84.322.0 00-2.6 49.53zm54.832-100.2c-18.627-17.387-38.964-31.808-61.2-44.965L119.7 159.357c29.816 15.76 52.067 30.719 69.575 45.639a84.135 84.135.0 0140.097-28.661zm20.63-4.1c1.983-.14 3.979-.237 6-.237a83.588 83.588.0 0141.393 10.916 251.959 251.959.0 00.78-28.448 297.8 297.8.0 00-6.564-53.245L256 80.664l-16.489 9.52c6.65 24.114 10.095 45.37 10.682 65.672Q250.433 164.112 250 172.237zm-64.76 129.007q-4.648 8.227-8.758 16.752a324.529 324.529.0 00-20.49 55.6l43.21 24.947c5.824-24.5 13.469-45.93 23.455-65.437A84.3 84.3.0 01185.242 301.244zM374.19 148.9c-19 18.863-37.743 34.831-58.691 47.809a83.826 83.826.0 0122.786 42.325c25.366-15.381 47.642-34.187 69.561-55.9v-14.8zM298.741 328.308A83.582 83.582.0 01256 340q-2.149.0-4.272-.108c1.842 4.863 3.807 9.68 5.93 14.446 8.355 18.751 19.118 37.369 33 56.991l41.757-24.108c-13.306-18.382-23.351-35.46-30.908-52.419C300.542 332.644 299.63 330.478 298.741 328.308zm40.874-64.358a83.578 83.578.0 01-18.131 44.635c26.246 8.936 54.539 14.141 86.362 16.028v-48.08a284.525 284.525.0 01-57.161-9.231Q345.087 265.763 339.615 263.95z" fill="#fff" opacity=".66"/><path id="Primary" d="M256 71.426l159.846 92.287V348.287L256 440.574 96.154 348.287V163.713L256 71.426M256 16 48.154 136V376L256 496 463.846 376V136L256 16zm0 204a36 36 0 11-25.456 10.544A35.767 35.767.0 01256 220m0-48a84 84 0 1059.4 24.6A83.738 83.738.0 00256 172z" fill="#fff"/><rect id="Frame" width="512" height="512" fill="none"/></g></svg></span><span class="text-uppercase font-weight-bold">KLTS.io</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/about/><span>关于</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/zh/blog/><span>博客</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/zh/docs/><span class=active>文档</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中文 Chinese
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/docs/>English</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off data-offline-search-index-json-src=/offline-search-index.4e6c2ffb05cb533734647be7b926ad8e.json data-offline-search-base-href=/ data-offline-search-max-results=10>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.
</p><p>
<a href=/zh/docs/>返回本页常规视图</a>.
</p>
</div>
<h1 class=title>文档</h1>
<ul>
<li>1: <a href=#pg-18d58d2666f9af2b2086e0baa55f315d>简介</a></li>
<li>2: <a href=#pg-50ddcb3cdb08fbe2ad5d04311c273b4c>准备</a></li>
<li>3: <a href=#pg-64407d3e6d5ef382426bdfbcae040c6a>正常安装</a></li>
<li>4: <a href=#pg-c170895d2a643e556fcae1338dee8dce>脚本一键安装</a></li>
<li>5: <a href=#pg-cf1a7e96c5bc452942429f7b1a8d0306>修复的漏洞</a></li>
<ul>
<li>5.1: <a href=#pg-be897afcde62036b99d0be161d71d482>CVE-2021-25741</a></li>
<li>5.2: <a href=#pg-d4317cf8912bca37373fe5558d2d6285>CVE-2021-3121</a></li>
<li>5.3: <a href=#pg-ce240d314dc85c8ab698d26f1466e5a2>CVE-2020-8559</a></li>
<li>5.4: <a href=#pg-5aa68ad2e414f83fec8b9beb2250fdd3>CVE-2020-8558</a></li>
<li>5.5: <a href=#pg-c1ec3633b18a80bee04f17816082420b>CVE-2020-8552</a></li>
<li>5.6: <a href=#pg-fa6c26ffb59581078942a7046be853db>CVE-2019-1002101</a></li>
<li>5.7: <a href=#pg-3bb42a6493fbd1d3d06aad85c3d8d1e7>CVE-2019-11251</a></li>
<li>5.8: <a href=#pg-da5de8654ce647927106ce1dae3b6382>CVE-2019-11248</a></li>
<li>5.9: <a href=#pg-d902d3ffd5b3d43bf94a51814ab569c7>CVE-2019-11247</a></li>
<li>5.10: <a href=#pg-17adf9e532c044f0bc96bf2fe6fabb70>CVE-2019-11246</a></li>
<li>5.11: <a href=#pg-678704d1c81cba20ab7f9af62e484052>CVE-2019-11245</a></li>
<li>5.12: <a href=#pg-9677918ea7ce2b1d4116bfb9d4d31512>CVE-2019-11249</a></li>
<li>5.13: <a href=#pg-66481705776642cc7da302c2a84c2907>nokmem</a></li>
</ul>
<li>6: <a href=#pg-810bac82108a5b9ba17ebba536d679bf>添加 CVE 补丁到 klts</a></li>
<li>7: <a href=#pg-9662232d61bca04520940eafdc2967e8>版本日志</a></li>
<ul>
<li>7.1: <a href=#pg-4fa179b3f919d394dbeffd1ed1605e46>v1.23</a></li>
<ul>
<li>7.1.1: <a href=#pg-0baa225c967bd1ebbf764e2a5b8a571a>v1.23.4-lts.1</a></li>
</ul>
<li>7.2: <a href=#pg-c047e6d1ee8dacb74e7c5d5ab95bebcd>v1.22</a></li>
<ul>
<li>7.2.1: <a href=#pg-0fc555ad48f02740e6bc8881266dd9ff>v1.22.7-lts.1</a></li>
</ul>
<li>7.3: <a href=#pg-01eb7d3a82aab93a8a4b1d1e7efdfef9>v1.21</a></li>
<ul>
<li>7.3.1: <a href=#pg-74446b3a77f744c15bc6cfdae5d25a02>v1.21.10-lts.1</a></li>
</ul>
<li>7.4: <a href=#pg-20753a751036d9825dd1807db9fedb5f>v1.20</a></li>
<ul>
<li>7.4.1: <a href=#pg-d3e3289a812dbea417a18b1b47ce7b91>v1.20.16-lts.1</a></li>
</ul>
<li>7.5: <a href=#pg-f9de07315ec208fab6e5c13024a2ce64>v1.19</a></li>
<ul>
<li>7.5.1: <a href=#pg-101e741dc17aaa2791af948b2cc29d09>v1.19.16-lts.1</a></li>
<li>7.5.2: <a href=#pg-f677a41be7eb5d233978046bb3cf15a0>v1.19.16-lts.2</a></li>
</ul>
<li>7.6: <a href=#pg-6525c9e3fb6b93a7733196db45f3decf>v1.18</a></li>
<ul>
<li>7.6.1: <a href=#pg-3aad22b5fa10ac4b1170fe162f9be940>v1.18.20-lts.1</a></li>
<li>7.6.2: <a href=#pg-b4c871eee2d42bdcff8479ff2298fc97>v1.18.20-lts.2</a></li>
</ul>
<li>7.7: <a href=#pg-2270bff767707e56d3db5151552ee5e7>v1.17</a></li>
<ul>
<li>7.7.1: <a href=#pg-1912fbf1f803c511b573029d327eaab7>v1.17.17-lts.1</a></li>
</ul>
<li>7.8: <a href=#pg-10a9386cc9c8d0a78f738e74e8017feb>v1.16</a></li>
<ul>
<li>7.8.1: <a href=#pg-d809e31f592dc7918fa421d4d5fcad8a>v1.16.15-lts.1</a></li>
</ul>
<li>7.9: <a href=#pg-1c3b45c2635fddab2687cd5bdd3887e5>v1.15</a></li>
<ul>
<li>7.9.1: <a href=#pg-93eb576cef91a97a721b738b99609a65>v1.15.12-lts.1</a></li>
</ul>
<li>7.10: <a href=#pg-b006ac46509d2d3406cd0499bc3f1517>v1.14</a></li>
<ul>
<li>7.10.1: <a href=#pg-73f06559fbf8770b07e5a1b9124b796a>v1.14.10-lts.1</a></li>
</ul>
<li>7.11: <a href=#pg-c07a278d274fb18221e937fe0cf11ad8>v1.13</a></li>
<ul>
<li>7.11.1: <a href=#pg-54d322ad1fac2f6a8afd50a52e4d49fa>v1.13.12-lts.1</a></li>
</ul>
<li>7.12: <a href=#pg-e7a48963a7388a7bdcf3c2e0efa67f24>v1.12</a></li>
<ul>
<li>7.12.1: <a href=#pg-821074ba2798466a54d10d5e0f367ac2>v1.12.10-lts.1</a></li>
</ul>
<li>7.13: <a href=#pg-4505b460b3d867cd384f7ee57eb36337>v1.11</a></li>
<ul>
<li>7.13.1: <a href=#pg-c06aa76c9df9f82bd046eb0f01e0ea9c>v1.11.10-lts.1</a></li>
</ul>
<li>7.14: <a href=#pg-bcc7e5c745acc27b204884b44e0c3cbb>v1.10</a></li>
<ul>
<li>7.14.1: <a href=#pg-ffbcd5ebf3f1c36ebfe008f5a6ad4f0b>v1.10.13-lts.1</a></li>
</ul>
</ul>
<li>8: <a href=#pg-4ea5ec9f40d271955e679919836ca15a>Containerd</a></li>
<ul>
<li>8.1: <a href=#pg-dfed8f673232f42492878a06c4fd00a2>修复的漏洞</a></li>
<ul>
<li>8.1.1: <a href=#pg-e9361514b1c4a6b356b66541847b30b2>CVE-2021-41103</a></li>
</ul>
<li>8.2: <a href=#pg-3e836e30cf6d82e7ba52f18ff1014469>版本日志</a></li>
<ul>
<li>8.2.1: <a href=#pg-d12c1156c3a7ffcccdbc9a23eaa464fb>v1.3</a></li>
<ul>
<li>8.2.1.1: <a href=#pg-ba6a1de6462c22fab2fedb173af0d8f2>v1.3.10-lts.1</a></li>
</ul>
</ul>
</ul>
<li>9: <a href=#pg-a7c9e10a31abdecaec5a338462a220a8>开发指南</a></li>
<ul>
<li>9.1: <a href=#pg-79fcc7e024580df9da30cdb10805eada>克隆</a></li>
<li>9.2: <a href=#pg-8da562538e76378aaf2ff1c50166f299>依赖</a></li>
</ul>
</ul>
<div class=content>
</div>
</div>
<div class=td-content>
<h1 id=pg-18d58d2666f9af2b2086e0baa55f315d>1 - 简介</h1>
<p>KLTS 全称为 Kubernetes Long Term Support，主要使命是为 Kubernetes 早期版本提供长期免费的维护支持。</p>
<p>之所以需要维护早期版本，是因为在实际生产环境中，最新版本不一定是最好的，也不是最稳定的。正常而言，Kubernetes 社区版本的维护周期只有一年左右，请参阅 <a href=#release-cycle>Kubernetes 版本发行周期</a>。在社区停止维护后，KLTS 在接下来的三年内提供免费维护服务。</p>
<p>在实际生产中，为什么大多数企业选择采用早期的 Kubernetes 版本管控集群呢？</p>
<ul>
<li>
<p>首先，升级频率高会带来变更风险，每次升级必须进行充分验证。特别是金融行业的平台层变更周期通常比较长，因为一旦升级后的新版本存在 bug，就需要被迫回滚或快速响应升级至更新的版本，这样会造成不必要的成本支出。</p>
</li>
<li>
<p>其次，Kubernetes 升级后部分功能的替代方案还没有完全生产就绪，在生产环境中常会出现不兼容的状况。</p>
</li>
<li>
<p>最后，Kubernetes 社区仅支持小版本 +1 升级，不支持跨版本升级，因为跨版本升级经常会出现一些不可控的因素，造成更大的生产问题。</p>
</li>
</ul>
<p>所以大多数企业的选择是沿用早期版本，不会贸然升级。但 Kubernetes 社区只维护最新的 3 到 4 个版本，如何才能保证这些早期版本免受社区不定时发现的 CVE 漏洞和 bug 的袭扰呢？这就是 KLTS 的价值所在！我们对早期版本提供长达 3 年的免费维护支持，积极修复早期版本的 CVE 安全漏洞和重大 bug。</p>
<h2 id=maint-cycle>KLTS 维护周期</h2>
<p>Kubernetes 版本号表示为 x.y.z，其中 x 是大版本号，y 是小版本号，z 是补丁版本，KLTS 提供的补丁版本号通常以 lts1、lts2 … ltsn 表示。为了方便表述，本节用前两位 x.y 描述 Kubernetes 版本号。</p>
<p>假设社区发布的最新 Kubernetes 版本为 x.y，根据<a href=https://kubernetes.io/releases/version-skew-policy/#supported-versions>社区版本维护声明</a>，社区仅维护最近的三个版本，而 KLTS 目前维护从 1.10 起的近十个早期版本，如下图所示。</p>
<img src=../klts_job.png width=750>
<p>当 Kubernetes 社区发现可能影响生产的 CVE 新漏洞或 bug，受到影响的可能不止是社区正在维护的版本，还有之前已经停止维护、但企业仍在使用、且不能贸然升级的版本，KLTS 团队维护的正是这些社区放弃维护的版本。目前 KLTS 的版本维护周期如下：</p>
<p><img src=../images/whatKLTSdoes.png alt="KLTS 维护版本"></p>
<p>从上图可看出，Kubernetes 社区对某个版本的维护周期通常在一年左右，而 KLTS 可以在接下来的三年内提供长期维护，直至代码无法兼容，才会将相应版本淘汰。</p>
<h2 id=bug-fix>KLTS 修复范围</h2>
<p>有些高优先级的 CVE 或严重 Bug 存在于生产环境中会造成较大的安全隐患。CVE 安全问题是集群的生命线，KLTS 会优先修复中高级别的 CVE，其次会修复重大 Bug，确保生产环境稳定运行。</p>
<p>以 2021 年 1 月发现的 <a href=https://www.cvedetails.com/cve/CVE-2021-3121>CVE-2021-3121</a> 安全漏洞为例，CVSS 危急分数高达 7.5。但截止 2021 年 9 月 Kubernetes 社区：</p>
<ul>
<li>仅修复了 4 个版本：1.18、1.19、1.20、1.21</li>
<li>宣称“所有早期版本均有这个安全漏洞，建议用户立即停止使用早期版本”</li>
<li>拒绝<a href=https://github.com/kubernetes/kubernetes/issues/101435>修复早期版本漏洞的要求</a></li>
</ul>
<p><img src=../images/cve2021.png alt=CVE-2021-3121></p>
<p>KLTS 针对这一现状，默默修复了深受 <a href=https://www.cvedetails.com/cve/CVE-2021-3121>CVE-2021-3121</a> 安全漏洞影响的 8 个早期版本：</p>
<ul>
<li>v1.17.17</li>
<li>v1.16.15</li>
<li>v1.15.12</li>
<li>v1.14.10</li>
<li>v1.13.12</li>
<li>v1.12.10</li>
<li>v1.11.10</li>
<li>v1.10.13</li>
</ul>
<p>如果您觉得 KLTS 团队的付出有价值，让您值得信赖，欢迎任何开发者加入 <a href=https://github.com/klts-io>KLTS 社区</a>交流并做出贡献。</p>
<h2 id=klts-benefits>欢迎携手培育硕果</h2>
<p>辛勤的耕耘，最终收获的是美丽花朵和累累硕果。经过开发者精心的维护支持，KLTS 为这些早期版本带来以下成果：</p>
<ul>
<li>
<p><strong>三年维护期</strong>：Kubernetes 社区对每个版本提供一年左右的维护，而 KLTS 接下来会为该版本提供长达三年的持续维护。</p>
</li>
<li>
<p><strong>安全稳定</strong>：小版本升级更安全，兼容性高。渐进式升级稳定性更好。譬如最新版本的新功能也许很有吸引力，但是不一定能达到生产可用的标准，需要较长时间的积累。</p>
</li>
<li>
<p><strong>易于安装</strong>：结合国内镜像加速，原生支持 Kubeadm，支持 CentOS、Ubuntu、openSUSE，还提供了一键安装脚本。</p>
</li>
<li>
<p><strong>公开透明</strong>：在 GitHub 托管的开源项目，全流程公开。</p>
</li>
<li>
<p><strong>全链路规划</strong>：后续会添加 Containerd 及其他组件的长期维护。</p>
</li>
</ul>
<p>在此也向广大的开发者，再次发出邀请，如果您觉得 KLTS 团队的付出有价值，让您值得信赖，欢迎任何开发者加入 KLTS 社区交流并贡献，期待您的任何意见、建议或解决方案。</p>
<ul>
<li>加入 <a href=https://github.com/klts-io>KLTS 社区</a></li>
<li>加入 <a href=https://klts.slack.com/archives/C02H8DMB6SZ>KLTS Slack 聊天频道</a></li>
</ul>
<h2 id=release-cycle>Kubernetes 版本发行周期</h2>
<p>Kubernetes 社区最近十多个版本的发布时间统计如下：</p>
<table>
<thead>
<tr>
<th style=text-align:left><strong>K8s 版本</strong></th>
<th style=text-align:left><strong>初次发布日期</strong></th>
<th style=text-align:left><strong>EOL 日期</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>1.10</td>
<td style=text-align:left>2018-03-27</td>
<td style=text-align:left>2019-02-13</td>
</tr>
<tr>
<td style=text-align:left>1.11</td>
<td style=text-align:left>2018-07-28</td>
<td style=text-align:left>2019-05-01</td>
</tr>
<tr>
<td style=text-align:left>1.12</td>
<td style=text-align:left>2018-09-28</td>
<td style=text-align:left>2019-07-08</td>
</tr>
<tr>
<td style=text-align:left>1.13</td>
<td style=text-align:left>2018-12-04</td>
<td style=text-align:left>2019-10-15</td>
</tr>
<tr>
<td style=text-align:left>1.14</td>
<td style=text-align:left>2019-03-25</td>
<td style=text-align:left>2019-12-11</td>
</tr>
<tr>
<td style=text-align:left>1.15</td>
<td style=text-align:left>2019-07-20</td>
<td style=text-align:left>2020-05-06</td>
</tr>
<tr>
<td style=text-align:left>1.16</td>
<td style=text-align:left>2019-09-18</td>
<td style=text-align:left>2020-09-02</td>
</tr>
<tr>
<td style=text-align:left>1.17</td>
<td style=text-align:left>2019-12-08</td>
<td style=text-align:left>2021-01-13</td>
</tr>
<tr>
<td style=text-align:left>1.18</td>
<td style=text-align:left>2020-03-25</td>
<td style=text-align:left>2021-06-18</td>
</tr>
<tr>
<td style=text-align:left>1.19</td>
<td style=text-align:left>2020-08-26</td>
<td style=text-align:left>2021-10-28</td>
</tr>
<tr>
<td style=text-align:left>1.20</td>
<td style=text-align:left>2020-12-08</td>
<td style=text-align:left>2022-02-28</td>
</tr>
<tr>
<td style=text-align:left>1.21</td>
<td style=text-align:left>2021-04-08</td>
<td style=text-align:left>2022-06-28</td>
</tr>
<tr>
<td style=text-align:left>1.22</td>
<td style=text-align:left>2021-08-04</td>
<td style=text-align:left>2022-10-28</td>
</tr>
</tbody>
</table>
<p>初次发布：指的是 Kubernetes 初次发布的 0 号版本，即 1.10.0、1.11.0 &mldr; 1.22.0 等。</p>
<p>EOL 全称为 End Of Life，即官方社区结束维护，通常发生在初次发布大约 1 年后，这也是官方社区发布的最后一个 bug fix 版本。</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-50ddcb3cdb08fbe2ad5d04311c273b4c>2 - 准备</h1>
<p><img src=https://raw.githubusercontent.com/kubernetes/kubeadm/master/logos/stacked/color/kubeadm-stacked-color.png align=right width=150px>本页介绍安装 Kubernetes 之前需要做好的一些准备工作，例如先要安装 <code>kubeadm</code> 工具箱。有关在安装此工具箱后如何用其创建集群，请参阅<a href=/zh/docs/install target>正常安装</a>。</p>
<h2 id=准备工作>准备工作</h2>
<ul>
<li>准备一台兼容的 Linux 主机。Kubernetes 项目为基于 Debian 和 Red Hat 的 Linux
发行版以及一些不提供包管理器的发行版提供通用的指令。</li>
<li>每台主机至少 2 GB 或更多的内存（如果内存太少将影响应用的运行）</li>
<li>CPU 2 核或更多</li>
<li>集群中所有主机的网络连通（公网和内网）</li>
<li>单个节点上不能有重复的主机名、MAC 地址或 product_uuid，请参阅<a href=#verify-mac-address target=_blank>确保每个节点上 MAC 地址和 product_uuid 的唯一性</a>。</li>
<li>开启主机上的某些端口，请参阅<a href=#check-required-ports target=_blank>检查所需端口</a>。</li>
<li>禁用交换分区。为了保证 kubelet 正常工作，您<strong>必须</strong>禁用交换分区。</li>
</ul>
<h2 id=verify-mac-address>确保每个节点上 MAC 地址和 product_uuid 的唯一性 </h2>
<ul>
<li>使用命令 <code>ip link</code> 或 <code>ifconfig -a</code> 来获取网络接口的 MAC 地址</li>
<li>使用 <code>sudo cat /sys/class/dmi/id/product_uuid</code> 命令来校验 product_uuid</li>
</ul>
<p>一般来讲，硬件设备拥有唯一的地址，但是有些虚拟机的地址可能会重复。
Kubernetes 使用 MAC 地址和 product_uuid 来确定集群中的唯一节点。
如果这些值在每个节点上不唯一，可能会导致安装<a href=https://github.com/kubernetes/kubeadm/issues/31 target=_blank>失败</a>。</p>
<h2 id=检查网络适配器>检查网络适配器</h2>
<p>如果您有一个以上的网络适配器，同时您的 Kubernetes 组件通过默认路由不可达，我们建议您预先添加 IP 路由规则，这样 Kubernetes 集群就可以通过对应的适配器完成连接。</p>
<h2 id=允许-iptables-检查桥接流量>允许 iptables 检查桥接流量</h2>
<p>确保 <code>br_netfilter</code> 模块被加载。这一操作可以通过运行 <code>lsmod | grep br_netfilter</code>
来完成。若要显式加载该模块，可执行命令 <code>sudo modprobe br_netfilter</code>。</p>
<p>为了让您的 Linux 节点上的 iptables 能够正确地查看桥接流量，您需要确保在
<code>sysctl</code> 配置中将 <code>net.bridge.bridge-nf-call-iptables</code> 设置为 1。例如：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf
</span><span style=color:#4e9a06>br_netfilter
</span><span style=color:#4e9a06>EOF</span>

cat <span style=color:#4e9a06>&lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
</span><span style=color:#4e9a06>net.bridge.bridge-nf-call-ip6tables = 1
</span><span style=color:#4e9a06>net.bridge.bridge-nf-call-iptables = 1
</span><span style=color:#4e9a06>EOF</span>
sudo sysctl --system
</code></pre></div><p>更多细节请查阅<a href=https://kubernetes.io/zh/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/#network-plugin-requirements target=_blank>网络插件需求</a>页面。</p>
<h2 id=check-required-ports>检查所需端口</h2>
<h3 id=控制平面节点>控制平面节点</h3>
<table>
<thead>
<tr>
<th>协议</th>
<th>方向</th>
<th>端口范围</th>
<th>作用</th>
<th>使用者</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>入站</td>
<td>6443</td>
<td>Kubernetes API 服务器</td>
<td>所有组件</td>
</tr>
<tr>
<td>TCP</td>
<td>入站</td>
<td>2379-2380</td>
<td>etcd 服务器客户端 API</td>
<td>kube-apiserver、etcd</td>
</tr>
<tr>
<td>TCP</td>
<td>入站</td>
<td>10250</td>
<td>Kubelet API</td>
<td>kubelet 自身、控制平面组件</td>
</tr>
<tr>
<td>TCP</td>
<td>入站</td>
<td>10251</td>
<td>kube-scheduler</td>
<td>kube-scheduler 自身</td>
</tr>
<tr>
<td>TCP</td>
<td>入站</td>
<td>10252</td>
<td>kube-controller-manager</td>
<td>kube-controller-manager 自身</td>
</tr>
</tbody>
</table>
<h3 id=工作节点>工作节点</h3>
<table>
<thead>
<tr>
<th>协议</th>
<th>方向</th>
<th>端口范围</th>
<th>作用</th>
<th>使用者</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>入站</td>
<td>10250</td>
<td>Kubelet API</td>
<td>kubelet 自身、控制平面组件</td>
</tr>
<tr>
<td>TCP</td>
<td>入站</td>
<td>30000-32767</td>
<td>NodePort 服务</td>
<td>所有组件</td>
</tr>
</tbody>
</table>
<p>以上是 <a href=https://kubernetes.io/zh/docs/concepts/services-networking/service/ target=_blank>NodePort 服务</a>的默认端口范围。</p>
<p>使用 * 标记的任意端口号都可以被覆盖，所以您需要保证定制的端口是开放的。</p>
<p>虽然控制平面节点已经包含了 etcd 的端口，您也可以使用自定义的外部 etcd 集群，或指定自定义端口。</p>
<p>您使用的 Pod 网络插件 (见下) 也可能需要某些特定端口开启。由于各个 Pod 网络插件都有所不同，请参阅相应文档中的端口要求。</p>
<h2 id=设置节点名字>设置节点名字</h2>
<p>命令的语法格式如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hostnamectl set-hostname your-new-host-name
<span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;127.0.0.1 </span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>&#34;</span> &gt;&gt; /etc/hosts
<span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;::1       </span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><h2 id=关闭-swap>关闭 Swap</h2>
<p>执行以下命令关闭 Swap：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>swapoff -a
</code></pre></div><p>如果需要永久关闭，请编辑 <code>/etc/fstab</code> 文件，将 swap 的挂载路径改为注释。</p>
<h2 id=关闭-selinux>关闭 Selinux</h2>
<p>执行以下命令关闭 Selinux：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>setenforce <span style=color:#0000cf;font-weight:700>0</span>
</code></pre></div><p>如果需要永久关闭，请编辑 <code>/etc/sysconfig/selinux</code> 将 <code>SELINUX=enforcing</code> 替换为 <code>SELINUX=disabled</code>。</p>
<h2 id=installing-runtime>安装 runtime</h2>
<p>为了在 Pod 中运行容器，Kubernetes 使用容器运行时（Container Runtime）。</p>
<ul class="nav nav-tabs" id=container-runtimes role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#container-runtimes-0 role=tab aria-controls=container-runtimes-0 aria-selected=true>Linux 节点</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#container-runtimes-1 role=tab aria-controls=container-runtimes-1>其它操作系统</a></li></ul>
<div class=tab-content id=container-runtimes><div id=container-runtimes-0 class="tab-pane show active" role=tabpanel aria-labelledby=container-runtimes-0>
<p><p>默认情况下，Kubernetes 使用容器运行时接口（Container Runtime Interface，CRI）来与您所选择的容器运行时交互。</p>
<p>如果您不指定运行时，则 kubeadm 会自动尝试检测系统上已经安装的运行时，方法是扫描一组众所周知的 Unix 域套接字。</p>
<p>下面的表格列举了一些容器运行时及其对应的套接字路径：</p>
<table>
<thead>
<tr>
<th>运行时</th>
<th>域套接字</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td>/var/run/dockershim.sock</td>
</tr>
<tr>
<td>Containerd</td>
<td>/run/containerd/containerd.sock</td>
</tr>
<tr>
<td>CRI-O</td>
<td>/var/run/crio/crio.sock</td>
</tr>
</tbody>
</table>
<br>
如果同时检测到 Docker 和 Containerd，则优先选择 Docker。
这是必然的，即使您仅安装了 Docker，因为 Docker 18.09 附带了 Containerd，所以两者都是可以检测到的。
如果检测到其他两个或多个运行时，则 kubeadm 输出错误信息并退出。
<p>kubelet 通过内置的 <code>dockershim</code> CRI 实现与 Docker 集成。</p>
</div>
<div id=container-runtimes-1 class=tab-pane role=tabpanel aria-labelledby=container-runtimes-1>
<p><p>默认情况下， kubeadm 使用 docker 作为容器运行时。kubelet 通过内置的 <code>dockershim</code> CRI 实现与 Docker 集成。</p>
</div></div>
<ul class="nav nav-tabs" id=tabset-zhdocspre-install-3 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocspre-install-3-0 role=tab aria-controls=tabset-zhdocspre-install-3-0 aria-selected=true>Docker</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocspre-install-3-1 role=tab aria-controls=tabset-zhdocspre-install-3-1>Containerd</a></li></ul>
<div class=tab-content id=tabset-zhdocspre-install-3><div id=tabset-zhdocspre-install-3-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocspre-install-3-0>
<p>
<ul class="nav nav-tabs" id=tabset-zhdocspre-install-2 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocspre-install-2-0 role=tab aria-controls=tabset-zhdocspre-install-2-0 aria-selected=true>基于 Red Hat 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocspre-install-2-1 role=tab aria-controls=tabset-zhdocspre-install-2-1>基于 Debian 的发行版</a></li></ul>
<div class=tab-content id=tabset-zhdocspre-install-2><div id=tabset-zhdocspre-install-2-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocspre-install-2-0>
<p><p>执行以下命令安装基于 Red Hat 发行版的 Docker：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yum install docker
</code></pre></div></div>
<div id=tabset-zhdocspre-install-2-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocspre-install-2-1>
<p><p>执行以下命令安装基于 Debian 发行版的 Docker：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>apt-get install docker.io
</code></pre></div></div></div>
</div>
<div id=tabset-zhdocspre-install-3-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocspre-install-3-1>
<p><p>Containerd 官方默认只提供 amd64 架构的下载包，如果您采用的是其他基础架构，
可以从 Docker 官方仓库安装 <code>containerd.io</code> 软件包。在<a href=https://docs.docker.com/engine/install/#server target=_blank>安装 Docker 引擎</a>中
找到为各自的 Linux 发行版设置 Docker 存储库和安装 containerd.io 软件包的有关说明。</p>
<p>也可以使用以下源代码构建。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.5.4
wget -c https://github.com/containerd/containerd/releases/download/v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>/containerd-<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>-linux-amd64.tar.gz
tar xvf containerd-<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>-linux-amd64.tar.gz -C /usr/local/
mkdir /etc/containerd/ <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> containerd config default &gt; /etc/containerd/config.toml
wget -c -O /etc/systemd/system/containerd.service https://raw.githubusercontent.com/containerd/containerd/main/containerd.service
systemctl start containerd <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> systemctl <span style=color:#204a87>enable</span> containerd
</code></pre></div></div></div>
<p>参阅<a href=https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes/ target=_blank>容器运行时</a>以了解更多信息。</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-64407d3e6d5ef382426bdfbcae040c6a>3 - 正常安装</h1>
<p>KLTS 提供了基于 deb 和 rpm 软件源的安装方式，您可以选择适合的安装方式。</p>
<p>安装前请确认已经完成了<a href=/zh/docs/pre-install target>准备</a>工作。</p>
<h2 id=设置-klts-软件源>设置 KLTS 软件源</h2>
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-3 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-3-0 role=tab aria-controls=tabset-zhdocsinstall-3-0 aria-selected=true>基于 Red Hat 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-3-1 role=tab aria-controls=tabset-zhdocsinstall-3-1>基于 Debian 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-3-2 role=tab aria-controls=tabset-zhdocsinstall-3-2>基于 Red Hat 的发行版, 国内加速 🚀</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-3-3 role=tab aria-controls=tabset-zhdocsinstall-3-3>基于 Debian 的发行版, 国内加速 🚀</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-3><div id=tabset-zhdocsinstall-3-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-3-0>
<p><p>执行以下代码设置下载 KLTS 的软件源：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://dl.klts.io/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div>
<div id=tabset-zhdocsinstall-3-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-3-1>
<p><p>执行以下代码设置下载 KLTS 的软件源：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://dl.klts.io/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div>
<div id=tabset-zhdocsinstall-3-2 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-3-2>
<p>
<strong>说明：</strong>以下加速均来自第三方, 安全和稳定性不做保障, 仅建议测试环境使用 ❗️❗️❗️ <br><br>
执行以下代码设置下载 KLTS 的软件源：
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-1 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-1-0 role=tab aria-controls=tabset-zhdocsinstall-1-0 aria-selected=true>/etc/hosts</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-1-1 role=tab aria-controls=tabset-zhdocsinstall-1-1>hub.fastgit.org</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-1-2 role=tab aria-controls=tabset-zhdocsinstall-1-2>ghproxy.com</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-1-3 role=tab aria-controls=tabset-zhdocsinstall-1-3>raw.githubusercontents.com</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-1-4 role=tab aria-controls=tabset-zhdocsinstall-1-4>raw.staticdn.net</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-1><div id=tabset-zhdocsinstall-1-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-1-0>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl https://raw.githubusercontent.com/wzshiming/github-hosts/master/hosts &gt;&gt;/etc/hosts

cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://dl.klts.io/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div>
<div id=tabset-zhdocsinstall-1-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-1-1>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://hub.fastgit.org/klts-io/kubernetes-lts/raw/repos/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div>
<div id=tabset-zhdocsinstall-1-2 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-1-2>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://ghproxy.com/https://raw.githubusercontent.com/klts-io/kubernetes-lts/repos/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div>
<div id=tabset-zhdocsinstall-1-3 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-1-3>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://raw.githubusercontents.com/klts-io/kubernetes-lts/repos/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div>
<div id=tabset-zhdocsinstall-1-4 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-1-4>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; \EOF &gt; /etc/yum.repos.d/klts.repo
</span><span style=color:#4e9a06>[klts]
</span><span style=color:#4e9a06>name=klts
</span><span style=color:#4e9a06>baseurl=https://raw.staticdn.net/klts-io/kubernetes-lts/repos/rpm/$basearch/
</span><span style=color:#4e9a06>enabled=1
</span><span style=color:#4e9a06>gpgcheck=0
</span><span style=color:#4e9a06>EOF</span>

yum makecache
</code></pre></div></div></div>
</div>
<div id=tabset-zhdocsinstall-3-3 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-3-3>
<p>
<strong>说明：</strong>以下加速均来自第三方, 安全和稳定性不做保障, 仅建议测试环境使用 ❗️❗️❗️<br><br>
执行以下代码设置下载 KLTS 的软件源：
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-2 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-2-0 role=tab aria-controls=tabset-zhdocsinstall-2-0 aria-selected=true>/etc/hosts</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-2-1 role=tab aria-controls=tabset-zhdocsinstall-2-1>hub.fastgit.org</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-2-2 role=tab aria-controls=tabset-zhdocsinstall-2-2>ghproxy.com</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-2-3 role=tab aria-controls=tabset-zhdocsinstall-2-3>raw.githubusercontents.com</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-2-4 role=tab aria-controls=tabset-zhdocsinstall-2-4>raw.staticdn.net</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-2><div id=tabset-zhdocsinstall-2-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-2-0>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl https://raw.githubusercontent.com/wzshiming/github-hosts/master/hosts &gt;&gt;/etc/hosts

cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://dl.klts.io/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div>
<div id=tabset-zhdocsinstall-2-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-2-1>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://hub.fastgit.org/klts-io/kubernetes-lts/raw/repos/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div>
<div id=tabset-zhdocsinstall-2-2 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-2-2>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://ghproxy.com/https://raw.githubusercontent.com/klts-io/kubernetes-lts/repos/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div>
<div id=tabset-zhdocsinstall-2-3 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-2-3>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://raw.githubusercontents.com/klts-io/kubernetes-lts/repos/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div>
<div id=tabset-zhdocsinstall-2-4 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-2-4>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; /etc/apt/sources.list.d/klts.list
</span><span style=color:#4e9a06>deb [trusted=yes] https://raw.staticdn.net/klts-io/kubernetes-lts/repos/deb stable main
</span><span style=color:#4e9a06>EOF</span>

apt-get update
</code></pre></div></div></div>
</div></div>
<h2 id=安装>安装</h2>
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-6 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-6-0 role=tab aria-controls=tabset-zhdocsinstall-6-0 aria-selected=true>安装最高版本</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-6-1 role=tab aria-controls=tabset-zhdocsinstall-6-1>安装指定版本</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-6><div id=tabset-zhdocsinstall-6-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-6-0>
<p>
<br>这里的最高版本指的是 KLTS 维护的最高版本。
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-4 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-4-0 role=tab aria-controls=tabset-zhdocsinstall-4-0 aria-selected=true>基于 Red Hat 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-4-1 role=tab aria-controls=tabset-zhdocsinstall-4-1>基于 Debian 的发行版</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-4><div id=tabset-zhdocsinstall-4-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-4-0>
<p><p>执行以下命令安装 KLTS 当前维护的最高版本的 Kubernetes：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yum install kubeadm kubelet kubectl
</code></pre></div></div>
<div id=tabset-zhdocsinstall-4-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-4-1>
<p><p>执行以下命令安装 KLTS 当前维护的最高版本的 Kubernetes：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>apt-get install kubeadm kubelet kubectl
</code></pre></div></div></div>
</div>
<div id=tabset-zhdocsinstall-6-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-6-1>
<p>
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-5 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-5-0 role=tab aria-controls=tabset-zhdocsinstall-5-0 aria-selected=true>基于 Red Hat 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-5-1 role=tab aria-controls=tabset-zhdocsinstall-5-1>基于 Debian 的发行版</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-5><div id=tabset-zhdocsinstall-5-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-5-0>
<p><p>执行以下命令安装指定版本的 Kubernetes：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># 搜索支持的版本</span>
yum search kubeadm --showduplicates <span style=color:#000;font-weight:700>|</span> grep kubeadm-

<span style=color:#8f5902;font-style:italic># 安装</span>
<span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
yum install kubeadm-v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span> kubelet-v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span> kubectl-v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div>
<div id=tabset-zhdocsinstall-5-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-5-1>
<p><p>执行以下命令安装指定版本的 Kubernetes：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># 搜索支持的版本</span>
apt-cache show kubeadm <span style=color:#000;font-weight:700>|</span> grep Version

<span style=color:#8f5902;font-style:italic># 安装</span>
<span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
apt-get install <span style=color:#000>kubeadm</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span> <span style=color:#000>kubelet</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span> <span style=color:#000>kubectl</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div></div>
</div></div>
<h2 id=开机自动启动-kubelet>开机自动启动 Kubelet</h2>
<p>执行以下命令开机自动启动 Kubelet：</p>
<pre><code>systemctl enable kubelet
</code></pre><h2 id=拉取依赖镜像>拉取依赖镜像</h2>
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-7 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-7-0 role=tab aria-controls=tabset-zhdocsinstall-7-0 aria-selected=true>默认</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-7-1 role=tab aria-controls=tabset-zhdocsinstall-7-1>国内加速 🚀</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-7><div id=tabset-zhdocsinstall-7-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-7-0>
<p><p>执行以下命令 pull 依赖的镜像：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
<span style=color:#000>REPOS</span><span style=color:#ce5c00;font-weight:700>=</span>ghcr.io/klts-io/kubernetes-lts
kubeadm config images pull --image-repository <span style=color:#4e9a06>${</span><span style=color:#000>REPOS</span><span style=color:#4e9a06>}</span> --kubernetes-version v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div>
<div id=tabset-zhdocsinstall-7-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-7-1>
<p><p>执行以下命令 pull 依赖的镜像：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
<span style=color:#000>REPOS</span><span style=color:#ce5c00;font-weight:700>=</span>ghcr.m.daocloud.io/klts-io/kubernetes-lts
kubeadm config images pull --image-repository <span style=color:#4e9a06>${</span><span style=color:#000>REPOS</span><span style=color:#4e9a06>}</span> --kubernetes-version v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div></div>
<p>后续对 kubeadm 的操作都需要加上 <code>--image-repository</code> 和 <code>--kubernetes-version</code> 以主动指定镜像。</p>
<h2 id=初始化控制面节点>初始化控制面节点</h2>
<ul class="nav nav-tabs" id=tabset-zhdocsinstall-8 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsinstall-8-0 role=tab aria-controls=tabset-zhdocsinstall-8-0 aria-selected=true>默认</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsinstall-8-1 role=tab aria-controls=tabset-zhdocsinstall-8-1>国内加速 🚀</a></li></ul>
<div class=tab-content id=tabset-zhdocsinstall-8><div id=tabset-zhdocsinstall-8-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsinstall-8-0>
<p><p>执行以下命令初始化控制面的节点：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
<span style=color:#000>REPOS</span><span style=color:#ce5c00;font-weight:700>=</span>ghcr.io/klts-io/kubernetes-lts
kubeadm init --image-repository <span style=color:#4e9a06>${</span><span style=color:#000>REPOS</span><span style=color:#4e9a06>}</span> --kubernetes-version v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div>
<div id=tabset-zhdocsinstall-8-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsinstall-8-1>
<p><p>执行以下命令初始化控制面的节点：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>1.18.20-lts.2
<span style=color:#000>REPOS</span><span style=color:#ce5c00;font-weight:700>=</span>ghcr.m.daocloud.io/klts-io/kubernetes-lts
kubeadm init --image-repository <span style=color:#4e9a06>${</span><span style=color:#000>REPOS</span><span style=color:#4e9a06>}</span> --kubernetes-version v<span style=color:#4e9a06>${</span><span style=color:#000>VERSION</span><span style=color:#4e9a06>}</span>
</code></pre></div></div></div>
<p>有关更多安装说明，请参阅 <a href=https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/ target=_blank>Kubernetes 操作指南</a>。</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-c170895d2a643e556fcae1338dee8dce>4 - 脚本一键安装</h1>
<p>KLTS 提供了以下脚本自动完成安装流程。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>wget https://github.com/klts-io/klts/raw/main/install.sh
chmod +x install.sh
./install.sh
</code></pre></div><pre><code class=language-console data-lang=console>Usage: ./install.sh [OPTIONS]
  -h, --help : Display this help and exit
  --kubernetes-container-registry=ghcr.io/klts-io/kubernetes-lts : Kubernetes container registry
  --kubernetes-version=1.18.20-lts.1 : Kubernetes version to install
  --containerd-version=1.3.10-lts.0 : Containerd version to install
  --runc-version=1.0.2-lts.0 : Runc version to install
  --kubernetes-rpm-source=https://github.com/klts-io/kubernetes-lts/raw/rpm-v1.18.20-lts.2 : Kubernetes RPM source
  --containerd-rpm-source=https://github.com/klts-io/containerd-lts/raw/rpm-v1.3.10-lts.0 : Containerd RPM source
  --runc-rpm-source=https://github.com/klts-io/runc-lts/raw/rpm-v1.0.2-lts.0 : Runc RPM source
  --others-rpm-source=https://github.com/klts-io/others/raw/rpm : Other RPM source
  --kubernetes-deb-source=https://github.com/klts-io/kubernetes-lts/raw/deb-v1.18.20-lts.2 : Kubernetes DEB source
  --containerd-deb-source=https://github.com/klts-io/containerd-lts/raw/deb-v1.3.10-lts.0 : Containerd DEB source
  --runc-deb-source=https://github.com/klts-io/runc-lts/raw/deb-v1.0.2-lts.0 : Runc DEB source
  --others-deb-source=https://github.com/klts-io/others/raw/deb : Other DEB source
  --focus=enable-iptables-discover-bridged-traffic,disable-swap,disable-selinux,setup-source,install-kubernetes,install-containerd,install-runc,install-crictl,install-cniplugins,setup-crictl-config,setup-containerd-cni-config,setup-kubelet-config,setup-containerd-config,daemon-reload,start-containerd,status-containerd,enable-containerd,start-kubelet,status-kubelet,enable-kubelet,images-pull,control-plane-init,status-nodes,show-join-command : Focus on specific step
  --skip='' : Skip on specific step
</code></pre>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-cf1a7e96c5bc452942429f7b1a8d0306>5 - 修复的漏洞</h1>
</div>
<div class=td-content>
<h1 id=pg-be897afcde62036b99d0be161d71d482>5.1 - CVE-2021-25741</h1>
<a href=https://www.cvedetails.com/cve/CVE-2021-25741/ target=_blank>漏洞详情</a>
<p>这是一个权限访问相关的卷安全性问题。用户可以在创建的容器中通过 <code>subpath</code> 的卷挂载方式访问到该卷挂载目录之外的文件和目录，包括主机的文件系统。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞影响 <code>kubelet</code> 相关行为，对于严格限制 <code>hostPath</code> 创建行为的集群管理员来说问题尤为严重。</p>
<h3 id=cvss>漏洞评分</h3>
<p>该漏洞为中危漏洞， <code>CVSS</code> 评分为 5.5。</p>
<h2 id=prevention>防范措施</h2>
<p>对于不想升级 <code>kubelet</code> 的用户来说，可以有两种防范措施：</p>
<ul>
<li>禁止 <code>kubelet</code>，<code>kube-apiserver</code> 的 <code>VolumeSubpath</code> 功能，并且移除所有正在使用该功能的 <code>pod</code>。</li>
<li>使用 <code>admission control</code> 防止信任度较低的用户使用 <code>root</code> 权限运行容器。</li>
</ul>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.22.2</li>
<li>v1.21.5</li>
<li>v1.20.11</li>
<li>v1.19.15</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.18/v1.18.20-lts.1 title="这是 KLTS 发布的第一个 v1.18.20 修复版本。" data-toggle=tooltip data-placement=top target>v1.18.20-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/104253.patch target=_blank>kubernetes/kubernetes#104253</a></li>
<li><a href=/zh/docs/releases/v1.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.16/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.15/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-d4317cf8912bca37373fe5558d2d6285>5.2 - CVE-2021-3121</h1>
<a href=https://www.cvedetails.com/cve/CVE-2021-3121 target=_blank>漏洞详情</a>
<p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>Kubernetes</code> 系统组件由于自身有应对崩溃的恢复机制，当遇到恶意提交的 <code>Protobuf</code> 消息时不会中断服务，所以不在该漏洞的影响范围内。</p>
<p>在应用系统中程序接收处理 <code>Protobuf</code> 消息时，如果组件没有应对崩溃的恢复机制，那么这类程序都在该漏洞影响范围内，且被恶意攻击时服务可能会中断。</p>
<p><code>Kubernetes</code> 社区经过测试验证 <code>API Server</code> 不受该漏洞的影响，但为了避免您受到该安全漏洞隐患的影响，社区对相关 <code>Protobuf</code> 文件进行了升级。</p>
<h2 id=prevention>防范措施</h2>
<p>如果在您的应用系统代码中使用了自动生成的 <code>Protobuf</code> 消息，并且发现相关组件因为以下异常退出，则可能存在该漏洞。</p>
<pre><code>panic: runtime error: index out of range [-9223372036854775804]

goroutine 1 [running]:

v1.(*MessageName).Unmarshal(0xc00006f1e8, 0xc0000281a8, 0xa, 0x10, 0xc00006f1b8, 0x1)

        .../protofile.pb.go:250 +0xb86
</code></pre><p>如果您使用了 <code>Protobuf</code> 消息的相关组件，推荐将 <code>Gogo Protobuf</code> 编译器升级到漏洞修复版本（v1.3.2 或更高的版本），再基于升级后的 <code>Protobuf</code> 编译器重新生成相关的 <code>Protobuf</code> 消息。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.21.1</li>
<li>v1.20.7</li>
<li>v1.19.11</li>
<li>v1.18.19</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.16/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.15/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/101327.patch target=_blank>kubernetes/kubernetes#101327</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ce240d314dc85c8ab698d26f1466e5a2>5.3 - CVE-2020-8559</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8559 target=_blank>漏洞详情</a>
<p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p>
<h2 id=scope>漏洞影响</h2>
<p>由于 <code>kube-apiserver</code> 在升级请求的代理后端中允许将请求传播回源客户端，所以攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，然后利用请求中原有的访问凭据转发请求至其他目标节点，从而造成被攻击节点出现权限提升的漏洞。</p>
<h3 id=cvss>漏洞评分</h3>
<p>该漏洞为中危漏洞， <code>CVSS</code> 评分为 6.4。
如果有多个集群共享使用了相同的 <code>CA</code> 和认证凭证，攻击者可以利用此漏洞攻击其他集群，这种情况下该漏洞为高危漏洞。</p>
<h2 id=prevention>防范措施</h2>
<p>对于集群内跨节点的攻击，建议您采取以下安全防范措施：</p>
<ul>
<li>及时吊销可能泄露的 <code>kubeconfig</code> 凭证，并且遵循权限最小化原则，收敛子账号不必要的 <code>pods/exec</code>、<code>pods/attach</code>、<code>pods/portforward</code> 和 <code>proxy</code> 类型的资源模型 <code>RBAC</code> 权限。</li>
</ul>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.18.6</li>
<li>v1.17.9</li>
<li>v1.16.13</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.15/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92971.patch target=_blank>kubernetes/kubernetes#92971</a></li>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92971.patch target=_blank>kubernetes/kubernetes#92971</a></li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> TODO</li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-5aa68ad2e414f83fec8b9beb2250fdd3>5.4 - CVE-2020-8558</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8558 target=_blank>漏洞详情</a>
<p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p>
<h2 id=scope>漏洞影响</h2>
<p>当攻击者拥有主机网络配置能力或运行在一个具备了 <code>CAP_NET_RAW</code> 能力的容器实例时，就可以获取在目标节点上监听 <code>127.0.0.1</code> 的服务 <code>socket</code> 信息。如果在目标主机上存在 <code>127.0.0.1</code> 可以访问且不需要任何认证鉴权的暴露服务，那么该服务信息就能被攻击者获取。</p>
<h3 id=cvss>漏洞评分</h3>
<ul>
<li>如果集群 <code>API Server</code> 开启了非认证端口（默认 8080），那么攻击者可能获取到 <code>API Server</code> 接口相关信息，威胁等级为高危漏洞，评分为 8.8 分。</li>
<li>如果集群 <code>API Server</code> 默认关闭了非认证端口，威胁等级为中危漏洞，评分为 5.4 分。</li>
</ul>
<h2 id=prevention>防范措施</h2>
<p>建议您采取以下安全防范措施：</p>
<p>如果业务容器需使用主机网络模式且又在非安全端口上监听，则可以通过在节点上手动添加 <code>iptables</code> 规则来缓解此漏洞。
执行以下命令在集群中配置 <code>iptables</code> 规则，用于拒绝非本地对 <code>127.0.0.1</code> 的访问流量：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP
</code></pre></div><p>如果集群不需要开启 API Server 不安全端口，可以将 <code>--insecure-port=0</code> 添加到 kubernetes API 服务器命令行来禁用端口。</p>
<p>如集群内运行不受信任的容器，可以禁止 <code>Container</code> 开启 <code>CAP_NET_RAW</code> 能力，在 <code>pod spec</code> 中关闭 <code>Container</code> 的 <code>CAP_NET_RAW</code> 能力。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>securityContext</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>capabilities</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>drop</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> 
</span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#4e9a06>&#34;NET_RAW&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>通过 <code>PodSecurityPolicy</code> 策略限制部署特权或共享主机网络容器，另外可以通过在策略中配置 <code>requiredDropCapabilities</code> 强制容器部署关闭 <code>CAP_NET_RAW</code> 能力。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.18.4</li>
<li>v1.17.7</li>
<li>v1.16.11</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.15/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/92040.patch target=_blank>kubernetes/kubernetes#92040</a></li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8558.1.12.patch target=_blank>CVE-2020-8558.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-c1ec3633b18a80bee04f17816082420b>5.5 - CVE-2020-8552</h1>
<a href=https://www.cvedetails.com/cve/CVE-2020-8552 target=_blank>漏洞详情</a>
<p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.17.3</li>
<li>v1.16.7</li>
<li>v1.15.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8552.1.14.patch target=_blank>CVE-2020-8552.1.14.patch</a></li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8552.1.13.patch target=_blank>CVE-2020-8552.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8552.1.13.patch target=_blank>CVE-2020-8552.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8552.1.11.patch target=_blank>CVE-2020-8552.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2020-8552.1.11.patch target=_blank>CVE-2020-8552.1.11.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-fa6c26ffb59581078942a7046be853db>5.6 - CVE-2019-1002101</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-1002101 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者在 <code>kubectl cp</code> 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。</p>
<h2 id=scope>漏洞影响</h2>
<p><code>kubectl cp</code> 命令允许用户在容器和用户机器之间拷贝文件，攻击者可能通过在镜像或运行容器中植入带有符号链接（symbolic links）头的恶意 <code>tar</code> 包，在 <code>cp</code> 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.1</li>
<li>v1.13.6</li>
<li>v1.12.8</li>
<li>v1.11.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-1002101.1.10.patch target=_blank>CVE-2019-1002101.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-3bb42a6493fbd1d3d06aad85c3d8d1e7>5.7 - CVE-2019-11251</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11251 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a>、<a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a>、<a href=/zh/docs/patches/cve-2019-11249 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11249</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝，当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，然后 <code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历(Path Traversal)。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.15.4</li>
<li>v1.14.7</li>
<li>v1.13.11</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/82503.patch target=_blank>kubernetes/kubernetes#82503</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/82503.patch target=_blank>kubernetes/kubernetes#82503</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11251.1.10.patch target=_blank>CVE-2019-11251.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-da5de8654ce647927106ce1dae3b6382>5.8 - CVE-2019-11248</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11248 target=_blank>漏洞详情</a>
<p>可以通过健康检查的端口访问 <code>/debug/pprof</code>。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞存在于 <code>Kubelet</code> 中，用于性能调试的 <code>/debug/pprof</code> 跟健康检查端口 <code>/healthz</code> 绑定在一起，其中 <code>/debug/pprof</code> 会进行安全认证，但 <code>/healthz</code> 接口并不进行认证鉴权。所以如果 <code>Kubelet</code> 的 <code>healthz</code> 地址未使用 <code>localhost</code>，则会存在泄露机器敏感信息的风险。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.4</li>
<li>v1.13.8</li>
<li>v1.12.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11248.1.11.patch target=_blank>CVE-2019-11248.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11248.1.11.patch target=_blank>CVE-2019-11248.1.11.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-d902d3ffd5b3d43bf94a51814ab569c7>5.9 - CVE-2019-11247</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11247 target=_blank>漏洞详情</a>
<p><code>API Server</code> 允许通过错误的范围访问自定义的资源。</p>
<h2 id=scope>漏洞影响</h2>
<p>如果某个用户请求的资源已划分到命名空间，Kubernetes kube-apiserver 将错误地允许该用户访问集群范围内的自定义资源。</p>
<p>以这种方式访问资源将等同于授予命名空间内所有角色及其权限，这意味着本来只能访问命名空间中一个资源的用户将能够创建、查看、更新或删除整个集群范围的资源（具体取决于其命名空间角色权限）。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.12.12</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11247.1.11.patch target=_blank>CVE-2019-11247.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> TODO</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-17adf9e532c044f0bc96bf2fe6fabb70>5.10 - CVE-2019-11246</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11246 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历 (Path Traversal) 的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝。当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，<code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历 (Path Traversal) 方式将恶意文件写入任意路径。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.3</li>
<li>v1.13.7</li>
<li>v1.12.10</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11246.1.11.patch target=_blank>CVE-2019-11246.1.11.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11246.1.10.patch target=_blank>CVE-2019-11246.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-678704d1c81cba20ab7f9af62e484052>5.11 - CVE-2019-11245</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11245 target=_blank>漏洞详情</a>
<p>这是一个提权漏洞，通常以容器 <code>Dockerfile</code> 中指定的 <code>USER</code> 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p>
<h2 id=scope>漏洞影响</h2>
<p>所有未指定 <code>mustRunAsNonRoot: true</code> 的 <code>Pod</code>，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p>
<h2 id=prevention>防范措施</h2>
<p>为 <code>Pod</code> 指定 <code>mustRunAsNonRoot: true</code>。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.14.3</li>
<li>v1.13.7</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/kubernetes/kubernetes/pull/78320.patch target=_blank>kubernetes/kubernetes#78320</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-9677918ea7ce2b1d4116bfb9d4d31512>5.12 - CVE-2019-11249</h1>
<a href=https://www.cvedetails.com/cve/CVE-2019-11249 target=_blank>漏洞详情</a>
<p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p>
<h2 id=scope>漏洞影响</h2>
<p>该漏洞与不久前的 <a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a>、<a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a> 漏洞影响相似。</p>
<p><code>kubectl cp</code> 命令用于用户容器和主机之间的文件拷贝，当从容器中拷贝文件时，<code>Kubernetes</code> 首先会在容器中执行 <code>tar</code> 命令创建相应的归档文件，然后发送给客户端，然后 <code>kubectl</code> 会在用户主机上进行相应解压操作。</p>
<p>如果容器 <code>tar</code> 包中包含恶意文件，当攻击者具有 <code>kubectl cp</code> 命令的执行权限时，可以利用路径遍历 (Path Traversal)。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.15.2</li>
<li>v1.14.5</li>
<li>v1.13.9</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.12.patch target=_blank>CVE-2019-11249.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.12.patch target=_blank>CVE-2019-11249.1.12.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/CVE-2019-11249.1.10.patch target=_blank>CVE-2019-11249.1.10.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-66481705776642cc7da302c2a84c2907>5.13 - nokmem</h1>
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1507149" target=_blank>Bug 详情</a>
<p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p>
<h2 id=scope>Bug 影响</h2>
<p>节点长期使用的时候提示剩余空间不足的错误，报错信息如下所示：</p>
<pre><code>mkdir: cannot create directory '/sys/fs/cgroup/memory/8': No space left on device
</code></pre><p>节点磁盘充足但是一直报和这个错误, 并且创建 <code>Pod</code> 总是失败，这是一个潜在的“定时炸弹”。</p>
<p>所有使用低版本内核的环境以及 Kubernetes 1.22 之前的版本都会受到影响，在 runc 1.0.0-rc94 (<a href=https://github.com/opencontainers/runc/pull/2840 target=_blank>opencontainers/runc#2840</a>) 进行了修复(被直接移除)。</p>
<h2 id=prevention>防范措施</h2>
<ul>
<li>升级系统内核</li>
<li>Kubernetes 1.14 及以上
<ul>
<li>重新构建 Kubelet 带上 <code>-tags=nokmem</code></li>
</ul>
</li>
<li>Kubernetes 1.14 以下
<ul>
<li>有关硬编码，请参考 <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
</ul>
</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/releases/v1.23/v1.23.4-lts.1 title="这是 KLTS 发布的第一个 v1.23.4 修复版本。" data-toggle=tooltip data-placement=top target>v1.23.4-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.22/v1.22.7-lts.1 title="这是 KLTS 发布的第一个 v1.22.7 修复版本。" data-toggle=tooltip data-placement=top target>v1.22.7-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.21/v1.21.10-lts.1 title="这是 KLTS 发布的第一个 v1.21.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.21.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.20/v1.20.16-lts.1 title="这是 KLTS 发布的第一个 v1.20.16 修复版本。" data-toggle=tooltip data-placement=top target>v1.20.16-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.19/v1.19.16-lts.1 title="这是 KLTS 发布的第一个 v1.19.16 修复版本。" data-toggle=tooltip data-placement=top target>v1.19.16-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.18/v1.18.20-lts.1 title="这是 KLTS 发布的第一个 v1.18.20 修复版本。" data-toggle=tooltip data-placement=top target>v1.18.20-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.17/v1.17.17-lts.1 title="这是 KLTS 发布的第一个 v1.17.17 修复版本。" data-toggle=tooltip data-placement=top target>v1.17.17-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.16/v1.16.15-lts.1 title="这是 KLTS 发布的第一个 v1.16.15 修复版本。" data-toggle=tooltip data-placement=top target>v1.16.15-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.15/v1.15.12-lts.1 title="这是 KLTS 发布的第一个 v1.15.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.15.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.14/v1.14.10-lts.1 title="这是 KLTS 发布的第一个 v1.14.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.14.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.19.patch target=_blank>nokmem.1.19.patch</a></li>
<li><a href=/zh/docs/releases/v1.13/v1.13.12-lts.1 title="这是 KLTS 发布的第一个 v1.13.12 修复版本。" data-toggle=tooltip data-placement=top target>v1.13.12-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.12/v1.12.10-lts.1 title="这是 KLTS 发布的第一个 v1.12.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.12.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.11/v1.11.10-lts.1 title="这是 KLTS 发布的第一个 v1.11.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.11.10-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
<li><a href=/zh/docs/releases/v1.10/v1.10.13-lts.1 title="这是 KLTS 发布的第一个 v1.10.13 修复版本。" data-toggle=tooltip data-placement=top target>v1.10.13-lts.1</a> <a href=https://github.com/klts-io/kubernetes-lts/raw/main/patches/nokmem.1.13.patch target=_blank>nokmem.1.13.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-810bac82108a5b9ba17ebba536d679bf>6 - 添加 CVE 补丁到 klts</h1>
<p>CVE 在 kubernetes 社区是持续更新的，我们需要在维护的所有版本中修复更新的 CVE 漏洞。基于源 patch 文件在低于此 patch 的版本更新出各个版本对应的 patch 文件。<code>klts</code> 有自动更新 patch 的功能，我们只需要解决冲突，保证代码的有效性和可用性。</p>
<p>下面将介绍如何把在 <code>klts</code> 中添加一个 CVE 补丁。</p>
<ol>
<li>先指定需要修复的 CVE 脚本，修改 <code>release.yaml</code>，先添加对应 CVE 的 <code>patch</code> 来源，此路径可以是一个链接，也可以下载到 <a href=https://github.com/klts-io/kubernetes-lts/tree/main/patches>/patches</a> 目录，<code>Score</code> 是代表这个 CVE 的优先级，数值越高说明对安全的影响更大。<code>&lt; k8s1.13</code> 表示在1.13（1.12，1.11，1.10）以下的版本都需要被解决漏洞。</li>
</ol>
<p>在1.12版本中运用 <code>CVE-2019-11253</code> patch 文件：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>     - name: v1.12.10-lts.1
        base_release: v1.12.10-ci
        must: <span style=color:#204a87>true</span>
        patches:
          - CVE-2019-11253

     <span style=color:#8f5902;font-style:italic># CVSS Score 5.0, &lt; k8s1.13, https://www.cvedetails.com/cve/CVE-2019-11253/</span>
     <span style=color:#8f5902;font-style:italic># TODO</span>
     - name: CVE-2019-11253
       patch:
          - https://github.com/kubernetes/kubernetes/pull/83436.patch
</code></pre></div><ol start=2>
<li>检查 <code>v1.12.10-lts.1</code> 是否能够完全运用此 patch，如果有冲突，将会手动去解决冲突代码。</li>
</ol>
<pre><code class=language-shel data-lang=shel>~/workspace/kubernetes-lts: main ± : make v1.12.10-lts.1
Checkout to v1.12.10-lts.1
./hack/checkout.sh v1.12.10-lts.1
remote: Enumerating objects: 77218, done.
remote: Counting objects: 100% (29330/29330), done.
remote: Compressing objects: 100% (11622/11622), done.
remote: Total 14180 (delta 7451), reused 5859 (delta 2116), pack-reused 0
Receiving objects: 100% (14180/14180), 15.77 MiB | 1.90 MiB/s, done.
Resolving deltas: 100% (7451/7451), completed with 4241 local objects.
Reset branch 'tag-v1.12.10'
</code></pre><p>如果输出下面的情况则表示这些文件有冲突：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>To restore the original branch and stop patching, run <span style=color:#4e9a06>&#34;git am --abort&#34;</span>.

+++ Conflicts detected:

UU Godeps/Godeps.json
UU staging/src/k8s.io/api/Godeps/Godeps.json
UU staging/src/k8s.io/apiextensions-apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/apimachinery/Godeps/Godeps.json
UU staging/src/k8s.io/apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/cli-runtime/Godeps/Godeps.json
UU staging/src/k8s.io/client-go/Godeps/Godeps.json
UU staging/src/k8s.io/csi-api/Godeps/Godeps.json
UU staging/src/k8s.io/kube-aggregator/Godeps/Godeps.json
UU staging/src/k8s.io/metrics/Godeps/Godeps.json
UU staging/src/k8s.io/sample-apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/sample-cli-plugin/Godeps/Godeps.json
UU staging/src/k8s.io/sample-controller/Godeps/Godeps.json
UU vendor/gopkg.in/yaml.v2/decode.go
UU vendor/gopkg.in/yaml.v2/encode.go
Aborting.

+++ Aborting in-progress git am.

+++ Returning you to the tag-v1.12.10 branch and cleaning up.
make: *** <span style=color:#ce5c00;font-weight:700>[</span>v1.12.10-lts.1<span style=color:#ce5c00;font-weight:700>]</span> Error <span style=color:#0000cf;font-weight:700>1</span>
</code></pre></div><blockquote>
<p>如果出现没法读取到某一个 patch 文件，请确保源 patch 文件正常下载到 <code>/tmp</code> 目录，请重新执行 <code>make</code> 命令。</p>
</blockquote>
<ol start=3>
<li>根据输出的信息，重新修改 <code>1.12</code> 的 patch 信息：</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>+++ About to attempt patch. To reattempt:
  $ git am -3 /path/to/kubernetes-lts/tmp/83436.patch

Applying: bump gopkg.in/yaml.v2 v2.2.4
Using index info to reconstruct a base tree...
M	Godeps/Godeps.json
M	staging/src/k8s.io/api/Godeps/Godeps.json
M	staging/src/k8s.io/apiextensions-apiserver/Godeps/Godeps.json
M	staging/src/k8s.io/apimachinery/Godeps/Godeps.json
M	staging/src/k8s.io/apiserver/Godeps/Godeps.json
M	staging/src/k8s.io/cli-runtime/Godeps/Godeps.json
M	staging/src/k8s.io/client-go/Godeps/Godeps.json
A	staging/src/k8s.io/cloud-provider/Godeps/Godeps.json
M	staging/src/k8s.io/csi-api/Godeps/Godeps.json
M	staging/src/k8s.io/kube-aggregator/Godeps/Godeps.json
M	staging/src/k8s.io/metrics/Godeps/Godeps.json
M	staging/src/k8s.io/sample-apiserver/Godeps/Godeps.json
M	staging/src/k8s.io/sample-cli-plugin/Godeps/Godeps.json
M	staging/src/k8s.io/sample-controller/Godeps/Godeps.json
M	vendor/gopkg.in/yaml.v2/decode.go
M	vendor/gopkg.in/yaml.v2/encode.go
M	vendor/gopkg.in/yaml.v2/resolve.go
M	vendor/gopkg.in/yaml.v2/scannerc.go
</code></pre></div><p>将 patch 复制到<a href=https://github.com/klts-io/kubernetes-lts/tree/main/patches>/patches</a>目录：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cp /path/to/kubernetes-lts/tmp/83436.patch patches/CVE-2019-11253.1.12.patch
</code></pre></div><p>重新修改 <code>release.yaml</code> 文件：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>- name: v1.12.10-lts.1
    base_release: v1.12.10-ci
    must: <span style=color:#204a87>true</span>
    patches:
      - CVE-2019-11253.1.12

<span style=color:#8f5902;font-style:italic># CVSS Score 5.0, &lt; k8s1.13, https://www.cvedetails.com/cve/CVE-2019-11253/</span>
     <span style=color:#8f5902;font-style:italic># TODO</span>
     - name: CVE-2019-11253
       patch:
          - https://github.com/kubernetes/kubernetes/pull/83436.patch
     - name: CVE-2019-11253.1.12
       patch:
          - patches/CVE-2019-11253.1.12.patch
</code></pre></div><ol start=3>
<li>手动解决冲突文件，请注意手动解决并不是只是简单的代码替换，要满足下面几个条件：</li>
</ol>
<ul>
<li>
<p>采用 patch 修改的内容</p>
</li>
<li>
<p>上下文没有语法错误</p>
</li>
<li>
<p>必须能通过测试用例</p>
</li>
</ul>
<p>执行下面命令解决冲突文件：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#000>QUIET</span><span style=color:#ce5c00;font-weight:700>=</span>n ./hack/format_patch.sh patches/CVE-2019-11253.1.12.patch

...

+++ Conflicts detected:

UU Godeps/Godeps.json
UU staging/src/k8s.io/api/Godeps/Godeps.json
UU staging/src/k8s.io/apiextensions-apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/apimachinery/Godeps/Godeps.json
UU staging/src/k8s.io/apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/cli-runtime/Godeps/Godeps.json
UU staging/src/k8s.io/client-go/Godeps/Godeps.json
UU staging/src/k8s.io/csi-api/Godeps/Godeps.json
UU staging/src/k8s.io/kube-aggregator/Godeps/Godeps.json
UU staging/src/k8s.io/metrics/Godeps/Godeps.json
UU staging/src/k8s.io/sample-apiserver/Godeps/Godeps.json
UU staging/src/k8s.io/sample-cli-plugin/Godeps/Godeps.json
UU staging/src/k8s.io/sample-controller/Godeps/Godeps.json
UU vendor/gopkg.in/yaml.v2/decode.go
UU vendor/gopkg.in/yaml.v2/encode.go

+++ Please resolve the conflicts in another window <span style=color:#ce5c00;font-weight:700>(</span>and remember to <span style=color:#4e9a06>&#39;git add / git am --continue&#39;</span><span style=color:#ce5c00;font-weight:700>)</span>
+++ Proceed <span style=color:#ce5c00;font-weight:700>(</span>anything but <span style=color:#4e9a06>&#39;y&#39;</span> aborts the patch<span style=color:#ce5c00;font-weight:700>)</span>? <span style=color:#ce5c00;font-weight:700>[</span>y/n<span style=color:#ce5c00;font-weight:700>]</span>
</code></pre></div><p>终端会暂停在冲突阶段，请注意此时需要<code>重新打开另一个终端</code>去解决冲突文件，待手动解决完所有冲突进行检查：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>~/path/to/kubernetes-lts/src/github.com/kubernetes/kubernetes:: tag-v1.12.10 ±✚ &gt;R&gt; : git add .
 ~/path/to/kubernetes-lts/src/github.com/kubernetes/kubernetes:: tag-v1.12.10 ✚ &gt;R&gt; : git am --continue
Applying: Limit YAML/JSON decode size
 ~/path/to/kubernetes-lts/src/github.com/kubernetes/kubernetes:: tag-v1.12.10 : git status
On branch tag-v1.12.10
nothing to commit, working tree clean
</code></pre></div><p>最重要的一步操作就是返回之前的终端，确认冲突已经完成，此时会去更新 <code>patches/CVE-2019-11253.1.12.patch</code>。</p>
<ol start=4>
<li>以上操作就是更新一个版本的 patch 整个操作，可以选择先提交到仓库跑 CI 的测试，如果当前版本的测试用例都通过了就说明此次修复有效。然后选择在此 patch 上向下兼容。修改 <code>release.yaml</code> 文件:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>- name: v1.12.10-lts.1
    base_release: v1.12.10-ci
    must: <span style=color:#204a87>true</span>
    patches:
      - CVE-2019-11253.1.12

- name: v1.11.10-lts.1
    base_release: v1.11.10-ci
    must: <span style=color:#204a87>true</span>
    patches:
      - CVE-2019-11253.1.11

<span style=color:#8f5902;font-style:italic># CVSS Score 5.0, &lt; k8s1.13, https://www.cvedetails.com/cve/CVE-2019-11253/</span>
     <span style=color:#8f5902;font-style:italic># TODO</span>
     - name: CVE-2019-11253
       patch:
          - https://github.com/kubernetes/kubernetes/pull/83436.patch
     - name: CVE-2019-11253.1.12
       patch:
          - patches/CVE-2019-11253.1.12.patch
     - name: CVE-2019-11253.1.11
       patch:
          - patches/CVE-2019-11253.1.11.patch
</code></pre></div><p>继续执行 <code>make v1.11.10-lts.1</code>，如果有冲突的话，重复以上动作修复。直到验证所最后一个版本（v1.10.13-lts.1）。</p>
<ol start=5>
<li>当所有的冲突解决完以后，并不意味代码将可以正常使用，必须通过 CI 的测试用例。目前 CI 只支持 <code>main</code> 分支。如果在自己的仓库，请在 main 分支进行修改，确保完全无误的情况下再提交 PR 申请合入 <a href=https://github.com/klts-io/kubernetes-lts>klts</a> 主分支。</li>
</ol>
<p>在 <code>github</code> 查看测试情况：</p>
<p><img src=../actions.png alt=actions></p>
<p>查看提交的所有 job 信息，下面说明 <code>1.15.12</code> 版本测试将不通过：</p>
<p><img src=../actions01.png alt=actions></p>
<p>查看报错信息详情，将错误解决完后重新提交，直到通过所有的测试。</p>
<p><img src=../actions02.png alt=actions></p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-9662232d61bca04520940eafdc2967e8>7 - 版本日志</h1>
</div>
<div class=td-content>
<h1 id=pg-4fa179b3f919d394dbeffd1ed1605e46>7.1 - v1.23</h1>
</div>
<div class=td-content>
<h1 id=pg-0baa225c967bd1ebbf764e2a5b8a571a>7.1.1 - v1.23.4-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.23.4 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-c047e6d1ee8dacb74e7c5d5ab95bebcd>7.2 - v1.22</h1>
</div>
<div class=td-content>
<h1 id=pg-0fc555ad48f02740e6bc8881266dd9ff>7.2.1 - v1.22.7-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.22.7 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-01eb7d3a82aab93a8a4b1d1e7efdfef9>7.3 - v1.21</h1>
</div>
<div class=td-content>
<h1 id=pg-74446b3a77f744c15bc6cfdae5d25a02>7.3.1 - v1.21.10-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.21.10 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-20753a751036d9825dd1807db9fedb5f>7.4 - v1.20</h1>
</div>
<div class=td-content>
<h1 id=pg-d3e3289a812dbea417a18b1b47ce7b91>7.4.1 - v1.20.16-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.20.16 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-f9de07315ec208fab6e5c13024a2ce64>7.5 - v1.19</h1>
</div>
<div class=td-content>
<h1 id=pg-101e741dc17aaa2791af948b2cc29d09>7.5.1 - v1.19.16-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.19.16 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-f677a41be7eb5d233978046bb3cf15a0>7.5.2 - v1.19.16-lts.2</h1>
<p>这是 KLTS 发布的第二个 v1.19.16 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2020-8554 target>/docs/patches/cve-2020-8554/</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-6525c9e3fb6b93a7733196db45f3decf>7.6 - v1.18</h1>
</div>
<div class=td-content>
<h1 id=pg-3aad22b5fa10ac4b1170fe162f9be940>7.6.1 - v1.18.20-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.18.20 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
<li><a href=/zh/docs/patches/cve-2021-25741 title="这是一个权限访问相关的卷安全性问题。用户可以在创建的容器中通过 subpath 的卷挂载方式访问到该卷挂载目录之外的文件和目录，包括主机的文件系统。" data-toggle=tooltip data-placement=top target>CVE-2021-25741</a><p>这是一个权限访问相关的卷安全性问题。用户可以在创建的容器中通过 <code>subpath</code> 的卷挂载方式访问到该卷挂载目录之外的文件和目录，包括主机的文件系统。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-b4c871eee2d42bdcff8479ff2298fc97>7.6.2 - v1.18.20-lts.2</h1>
<p>这是 KLTS 发布的第二个 v1.18.20 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li>修复问题: kubelet 重启后创建的新 pod 缺少环境变量 KUBERNETES_SERVICE_HOST</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-2270bff767707e56d3db5151552ee5e7>7.7 - v1.17</h1>
</div>
<div class=td-content>
<h1 id=pg-1912fbf1f803c511b573029d327eaab7>7.7.1 - v1.17.17-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.17.17 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-10a9386cc9c8d0a78f738e74e8017feb>7.8 - v1.16</h1>
</div>
<div class=td-content>
<h1 id=pg-d809e31f592dc7918fa421d4d5fcad8a>7.8.1 - v1.16.15-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.16.15 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-1c3b45c2635fddab2687cd5bdd3887e5>7.9 - v1.15</h1>
</div>
<div class=td-content>
<h1 id=pg-93eb576cef91a97a721b738b99609a65>7.9.1 - v1.15.12-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.15.12 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-b006ac46509d2d3406cd0499bc3f1517>7.10 - v1.14</h1>
</div>
<div class=td-content>
<h1 id=pg-73f06559fbf8770b07e5a1b9124b796a>7.10.1 - v1.14.10-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.14.10 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2020-8552 title="此漏洞可能使 API Server 易于遭受 API 请求成功造成的 DoS（拒绝服务攻击）。" data-toggle=tooltip data-placement=top target>CVE-2020-8552</a><p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8559 title="这是 kube-apiserver 组件的安全漏洞，攻击者可以通过截取某些发送至节点 kubelet 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。" data-toggle=tooltip data-placement=top target>CVE-2020-8559</a><p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-c07a278d274fb18221e937fe0cf11ad8>7.11 - v1.13</h1>
</div>
<div class=td-content>
<h1 id=pg-54d322ad1fac2f6a8afd50a52e4d49fa>7.11.1 - v1.13.12-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.13.12 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2020-8552 title="此漏洞可能使 API Server 易于遭受 API 请求成功造成的 DoS（拒绝服务攻击）。" data-toggle=tooltip data-placement=top target>CVE-2020-8552</a><p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2020-8559 title="这是 kube-apiserver 组件的安全漏洞，攻击者可以通过截取某些发送至节点 kubelet 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。" data-toggle=tooltip data-placement=top target>CVE-2020-8559</a><p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-e7a48963a7388a7bdcf3c2e0efa67f24>7.12 - v1.12</h1>
</div>
<div class=td-content>
<h1 id=pg-821074ba2798466a54d10d5e0f367ac2>7.12.1 - v1.12.10-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.12.10 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2019-11245 title="这是一个提权漏洞，通常以容器 Dockerfile 中指定的 USER 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 root(uid 0) 身份运行。" data-toggle=tooltip data-placement=top target>CVE-2019-11245</a><p>这是一个提权漏洞，通常以容器 <code>Dockerfile</code> 中指定的 <code>USER</code> 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11247 title="API Server 允许通过错误的范围访问自定义的资源。" data-toggle=tooltip data-placement=top target>CVE-2019-11247</a><p><code>API Server</code> 允许通过错误的范围访问自定义的资源。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11249 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11249</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11251 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11251</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8552 title="此漏洞可能使 API Server 易于遭受 API 请求成功造成的 DoS（拒绝服务攻击）。" data-toggle=tooltip data-placement=top target>CVE-2020-8552</a><p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2020-8559 title="这是 kube-apiserver 组件的安全漏洞，攻击者可以通过截取某些发送至节点 kubelet 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。" data-toggle=tooltip data-placement=top target>CVE-2020-8559</a><p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-4505b460b3d867cd384f7ee57eb36337>7.13 - v1.11</h1>
</div>
<div class=td-content>
<h1 id=pg-c06aa76c9df9f82bd046eb0f01e0ea9c>7.13.1 - v1.11.10-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.11.10 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2019-11245 title="这是一个提权漏洞，通常以容器 Dockerfile 中指定的 USER 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 root(uid 0) 身份运行。" data-toggle=tooltip data-placement=top target>CVE-2019-11245</a><p>这是一个提权漏洞，通常以容器 <code>Dockerfile</code> 中指定的 <code>USER</code> 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历 (Path Traversal) 的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11247 title="API Server 允许通过错误的范围访问自定义的资源。" data-toggle=tooltip data-placement=top target>CVE-2019-11247</a><p><code>API Server</code> 允许通过错误的范围访问自定义的资源。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11248 title="可以通过健康检查的端口访问 /debug/pprof。" data-toggle=tooltip data-placement=top target>CVE-2019-11248</a><p>可以通过健康检查的端口访问 <code>/debug/pprof</code>。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11249 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11249</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11251 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11251</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8552 title="此漏洞可能使 API Server 易于遭受 API 请求成功造成的 DoS（拒绝服务攻击）。" data-toggle=tooltip data-placement=top target>CVE-2020-8552</a><p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2020-8559 title="这是 kube-apiserver 组件的安全漏洞，攻击者可以通过截取某些发送至节点 kubelet 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。" data-toggle=tooltip data-placement=top target>CVE-2020-8559</a><p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-bcc7e5c745acc27b204884b44e0c3cbb>7.14 - v1.10</h1>
</div>
<div class=td-content>
<h1 id=pg-ffbcd5ebf3f1c36ebfe008f5a6ad4f0b>7.14.1 - v1.10.13-lts.1</h1>
<p>这是 KLTS 发布的第一个 v1.10.13 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/patches/cve-2019-11245 title="这是一个提权漏洞，通常以容器 Dockerfile 中指定的 USER 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 root(uid 0) 身份运行。" data-toggle=tooltip data-placement=top target>CVE-2019-11245</a><p>这是一个提权漏洞，通常以容器 <code>Dockerfile</code> 中指定的 <code>USER</code> 运行的容器，在容器重启时或者如果镜像先前被拉到节点时，都将以 <code>root</code>(uid 0) 身份运行。</p></li>
<li><a href=/zh/docs/patches/cve-2019-1002101 title="此漏洞可能允许攻击者在 kubectl cp 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。" data-toggle=tooltip data-placement=top target>CVE-2019-1002101</a><p>此漏洞可能允许攻击者在 <code>kubectl cp</code> 命令执行解压过程中修改或监控符号链接头同名目录下的任意文件，从而造成破坏。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11246 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历 (Path Traversal) 的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11246</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历 (Path Traversal) 的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2019-11247 title="API Server 允许通过错误的范围访问自定义的资源。" data-toggle=tooltip data-placement=top target>CVE-2019-11247</a><p><code>API Server</code> 允许通过错误的范围访问自定义的资源。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11248 title="可以通过健康检查的端口访问 /debug/pprof。" data-toggle=tooltip data-placement=top target>CVE-2019-11248</a><p>可以通过健康检查的端口访问 <code>/debug/pprof</code>。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11249 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11249</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2019-11251 title="此漏洞可能允许攻击者利用 kubectl cp 命令，采用路径遍历(Path Traversal)的方式将容器 tar 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。" data-toggle=tooltip data-placement=top target>CVE-2019-11251</a><p>此漏洞可能允许攻击者利用 <code>kubectl cp</code> 命令，采用路径遍历(Path Traversal)的方式将容器 <code>tar</code> 包中的恶意文件写入所在主机上的任何路径，该过程仅受本地用户的系统权限限制。</p></li>
<li><a href=/zh/docs/patches/cve-2020-8552 title="此漏洞可能使 API Server 易于遭受 API 请求成功造成的 DoS（拒绝服务攻击）。" data-toggle=tooltip data-placement=top target>CVE-2020-8552</a><p>此漏洞可能使 <code>API Server</code> 易于遭受 <code>API</code> 请求成功造成的 <code>DoS</code>（拒绝服务攻击）。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2020-8558 title="kube-proxy 组件在 iptables 和 ipvs 模式下均需要设置内核参数 net.ipv4.conf.all.route_localnet=1， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 127.0.0.1 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。" data-toggle=tooltip data-placement=top target>CVE-2020-8558</a><p><code>kube-proxy</code> 组件在 <code>iptables</code> 和 <code>ipvs</code> 模式下均需要设置内核参数 <code>net.ipv4.conf.all.route_localnet=1</code>， 从而允许本地回环访问。攻击者可能通过共享主机网络的容器，或在集群节点访问同一个 LAN 或二层网络下的相邻节点上绑定监听本地 <code>127.0.0.1</code> 端口的 TCP/UDP 服务，从而获取接口信息。如果您的服务没有设置必要的安全认证，可能会造成信息泄露风险。</p></li>
<li>TODO <a href=/zh/docs/patches/cve-2020-8559 title="这是 kube-apiserver 组件的安全漏洞，攻击者可以通过截取某些发送至节点 kubelet 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。" data-toggle=tooltip data-placement=top target>CVE-2020-8559</a><p>这是 <code>kube-apiserver</code> 组件的安全漏洞，攻击者可以通过截取某些发送至节点 <code>kubelet</code> 的升级请求，通过请求中原有的访问凭据转发请求至其他目标节点，从而造成节点权限提升的漏洞。</p></li>
<li><a href=/zh/docs/patches/cve-2021-3121 title="存在该漏洞的程序可能会因为处理了包含恶意 Protobuf 消息而崩溃。如果您使用的 Gogo Protobuf 版本过低，可能存在该漏洞。" data-toggle=tooltip data-placement=top target>CVE-2021-3121</a><p>存在该漏洞的程序可能会因为处理了包含恶意 <code>Protobuf</code> 消息而崩溃。如果您使用的 <code>Gogo Protobuf</code> 版本过低，可能存在该漏洞。</p></li>
<li><a href=/zh/docs/patches/nokmem title="节点磁盘充足但是一直报磁盘不足无法创建 Pod。" data-toggle=tooltip data-placement=top target>nokmem</a><p>节点磁盘充足但是一直报磁盘不足无法创建 <code>Pod</code>。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-4ea5ec9f40d271955e679919836ca15a>8 - Containerd</h1>
</div>
<div class=td-content>
<h1 id=pg-dfed8f673232f42492878a06c4fd00a2>8.1 - 修复的漏洞</h1>
</div>
<div class=td-content>
<h1 id=pg-e9361514b1c4a6b356b66541847b30b2>8.1.1 - CVE-2021-41103</h1>
<p><a href=https://www.cvedetails.com/cve/CVE-2021-41103 target=_blank>漏洞详情</a>
<a href="https://github.com/containerd/containerd/security/advisories/GHSA-c2h3-6mxw-7mvq?spm=a2c4g.11186623.0.0.392834c1nttyAo" target=_blank>漏洞详情(官方)</a></p>
<p>在容器根目录和一些系统插件中缺少必要的权限约束时，可使一个非特权的主机 Linux 用户拥有遍历容器文件系统并执行目标程序的权限。</p>
<h2 id=scope>漏洞影响</h2>
<p>在多租户场景下，如果集群节点中的容器包含扩展权限（例如 setuid），非特权的 Linux 用户可能发现并执行该程序。如果非特权的主机 Linux 用户 UID 碰撞到了容器中执行程序的所属用户或组，这个非特权的 Linux 用户可以读写该文件从而导致越权访问。</p>
<h3 id=cvss>漏洞评分</h3>
<p>该漏洞为高危漏洞， <code>CVSS</code> 评分为 7.2。</p>
<h2 id=prevention>防范措施</h2>
<p>保证集群节点登录用户都是可信用户，限制非受信用户对集群节点的访问权限。
收敛容器 bundles 目录中不必要的扩展权限。</p>
<h2 id=official-fixed>官方修复的版本</h2>
<ul>
<li>v1.4.11</li>
<li>v1.5.7</li>
</ul>
<h2 id=klts-fixed>KLTS 修复的版本</h2>
<ul>
<li><a href=/zh/docs/containerd/releases/v1.3/v1.3.10-lts.1 title="这是 KLTS Containerd 发布的第一个 v1.3.10 修复版本。" data-toggle=tooltip data-placement=top target>v1.3.10-lts.1</a> <a href=https://github.com/klts-io/containerd-lts/raw/main/patches/CVE-2021-41103.1.3.patch target=_blank>CVE-2021-41103.1.3.patch</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-3e836e30cf6d82e7ba52f18ff1014469>8.2 - 版本日志</h1>
</div>
<div class=td-content>
<h1 id=pg-d12c1156c3a7ffcccdbc9a23eaa464fb>8.2.1 - v1.3</h1>
</div>
<div class=td-content>
<h1 id=pg-ba6a1de6462c22fab2fedb173af0d8f2>8.2.1.1 - v1.3.10-lts.1</h1>
<p>这是 KLTS Containerd 发布的第一个 v1.3.10 修复版本。</p>
<h2 id=补丁>补丁</h2>
<ul>
<li><a href=/zh/docs/containerd/patches/cve-2021-41103 title="在容器根目录和一些系统插件中缺少必要的权限约束时，可使一个非特权的主机 Linux 用户拥有遍历容器文件系统并执行目标程序的权限。" data-toggle=tooltip data-placement=top target>CVE-2021-41103</a><p>在容器根目录和一些系统插件中缺少必要的权限约束时，可使一个非特权的主机 Linux 用户拥有遍历容器文件系统并执行目标程序的权限。</p></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a7c9e10a31abdecaec5a338462a220a8>9 - 开发指南</h1>
</div>
<div class=td-content>
<h1 id=pg-79fcc7e024580df9da30cdb10805eada>9.1 - 克隆</h1>
<p>本页介绍如何将 Kubernetes master 分支克隆到本地。</p>
<h2 id=克隆主分支>克隆主分支</h2>
<p>请尝试只克隆主分支，由于 repos 仓库作为 rpm 和 deb 的软件源，直接克隆全部会非常大。</p>
<p>可执行以下命令克隆主分支：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone --single-branch -b main https://github.com/klts-io/kubernetes-lts
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-8da562538e76378aaf2ff1c50166f299>9.2 - 依赖</h1>
<p>本页介绍如何在不同的操作系统上安装依赖。</p>
<h2 id=安装依赖>安装依赖</h2>
<ul class="nav nav-tabs" id=tabset-zhdocsdeveloper-guidedependent-1 role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabset-zhdocsdeveloper-guidedependent-1-0 role=tab aria-controls=tabset-zhdocsdeveloper-guidedependent-1-0 aria-selected=true>MacOS</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsdeveloper-guidedependent-1-1 role=tab aria-controls=tabset-zhdocsdeveloper-guidedependent-1-1>基于 Red Hat 的发行版</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabset-zhdocsdeveloper-guidedependent-1-2 role=tab aria-controls=tabset-zhdocsdeveloper-guidedependent-1-2>基于 Debian 的发行版</a></li></ul>
<div class=tab-content id=tabset-zhdocsdeveloper-guidedependent-1><div id=tabset-zhdocsdeveloper-guidedependent-1-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabset-zhdocsdeveloper-guidedependent-1-0>
<p><p>运行以下命令安装依赖：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install jq git python@3 <span style=color:#8f5902;font-style:italic># 安装 brew, 请看 https://brew.sh/</span>
pip3 install yq
</code></pre></div></div>
<div id=tabset-zhdocsdeveloper-guidedependent-1-1 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsdeveloper-guidedependent-1-1>
<p><p>运行以下命令安装依赖：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yum install -y epel-release
yum install -y jq git python3
pip3 install yq
</code></pre></div></div>
<div id=tabset-zhdocsdeveloper-guidedependent-1-2 class=tab-pane role=tabpanel aria-labelledby=tabset-zhdocsdeveloper-guidedependent-1-2>
<p><p>运行以下命令安装依赖：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>apt-get install -y jq git python3 python3-pip
pip3 install yq
</code></pre></div></div></div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/klts-io aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack>
<a class=text-white target=_blank rel=noopener href=https://klts.slack.com aria-label=Slack>
<i class="fab fa-slack"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list">
<a class=text-white target=_blank rel=noopener href=mailto:klts-io@googlegroups.com aria-label="Developer mailing list">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 The KLTS.io Authors 版权所有</small>
<p class=mt-2><a href=/zh/about/>关于 KLTS</a></p>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script>
</body>
</html>